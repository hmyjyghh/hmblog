(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{599:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"基本数据类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本数据类型"}},[t._v("#")]),t._v(" 基本数据类型")]),t._v(" "),s("ol",[s("li",[t._v("数字（Number）")]),t._v(" "),s("li",[t._v("字符串（String）")]),t._v(" "),s("li",[t._v("列表（List）")]),t._v(" "),s("li",[t._v("元组（Tuple）")]),t._v(" "),s("li",[t._v("字典（Dictionary）")]),t._v(" "),s("li",[t._v("集合（Set）")]),t._v(" "),s("li",[t._v("布尔值（Boolean）")]),t._v(" "),s("li",[t._v("空值（None）")])]),t._v(" "),s("p",[t._v("list = ['123', 46, 'str'];")]),t._v(" "),s("p",[t._v("元组（Tuple）\ntuple = ('123', 46, 'str');")]),t._v(" "),s("p",[t._v("字典（Dictionary）\ndict = {'name': '张三', 'age': 18};")]),t._v(" "),s("p",[t._v("元组的元素不能修改")]),t._v(" "),s("p",[t._v("List 和  元组  都是   里面的元素类型可以不一样")]),t._v(" "),s("p",[t._v("字典：它是一个无序的 键(key) : 值(value) 的集合。")]),t._v(" "),s("h3",{attrs:{id:"_1-python-中的序列切片语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-python-中的序列切片语法"}},[t._v("#")]),t._v(" 1. Python 中的"),s("strong",[t._v("序列切片语法")])]),t._v(" "),s("blockquote",[s("p",[t._v("截取列表（或序列）的最后 N 个元素")])]),t._v(" "),s("p",[s("code",[t._v("history = history[-MAX_HISTORY:]")]),t._v(" 的核心作用是"),s("strong",[t._v("强制将 "),s("code",[t._v("history")]),t._v(" 截断为最后 5 个元素")]),t._v("，确保其长度最多为 5，")]),t._v(" "),s("ul",[s("li",[t._v("常用于限制历史记录（如"),s("strong",[t._v("对话")]),t._v("、操作日志、数据缓存）的长度。")])]),t._v(" "),s("h4",{attrs:{id:"场景-1-history-长度-6-截断"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景-1-history-长度-6-截断"}},[t._v("#")]),t._v(" 场景 1：history 长度 > 6（截断）")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("MAX_HISTORY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 长度为8")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MAX_HISTORY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出：[3, 4, 5, 6, 7, 8]（只保留最后6个）")]),t._v("\n")])])]),s("h4",{attrs:{id:"场景-2-history-长度-6-无变化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景-2-history-长度-6-无变化"}},[t._v("#")]),t._v(" 场景 2：history 长度 = 6（无变化）")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("MAX_HISTORY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 长度为6")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MAX_HISTORY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出：[1, 2, 3, 4, 5, 6]（原样保留）")]),t._v("\n")])])]),s("h4",{attrs:{id:"场景-3-history-长度-6-保留全部"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景-3-history-长度-6-保留全部"}},[t._v("#")]),t._v(" 场景 3：history 长度 < 6（保留全部）")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("MAX_HISTORY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 长度为3")]),t._v("\nhistory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("MAX_HISTORY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出：[1, 2, 3]（不足6个时，不截断，保留所有）")]),t._v("\n")])])]),s("h3",{attrs:{id:"核心用途"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心用途"}},[t._v("#")]),t._v(" 核心用途")]),t._v(" "),s("p",[t._v("这行代码是限制历史记录长度的“惯用写法”，比如：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("聊天机器人的对话历史，只保留最近 5 轮")]),t._v("；")]),t._v(" "),s("li",[t._v("传感器数据缓存，只存最近 5 条采集值；")]),t._v(" "),s("li",[t._v("操作日志，只保留最近 5 次操作记录。")])]),t._v(" "),s("h3",{attrs:{id:"补充说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[t._v("#")]),t._v(" 补充说明")]),t._v(" "),s("ul",[s("li",[t._v("若 "),s("code",[t._v("history")]),t._v(" 是空序列（如 "),s("code",[t._v("[]")]),t._v("），执行后仍为空，不会报错；")]),t._v(" "),s("li",[t._v("该语法对字符串、元组等可切片对象同样生效（元组执行后仍为元组，列表仍为列表）。")])]),t._v(" "),s("h3",{attrs:{id:"核心用途-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心用途-2"}},[t._v("#")]),t._v(" 核心用途")]),t._v(" "),s("p",[t._v("这行代码常用于“分组处理”场景，比如：")]),t._v(" "),s("ol",[s("li",[t._v("对话历史分组：将连续的聊天记录按“一问一答（2 条为一组）”拆分；")]),t._v(" "),s("li",[t._v("数据成对处理：传感器采集的成对数据（如温度+湿度）分组；")]),t._v(" "),s("li",[t._v("批量处理：按固定数量（2 个）拆分列表，方便后续批量操作。")])]),t._v(" "),s("h3",{attrs:{id:"补充注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充注意"}},[t._v("#")]),t._v(" 补充注意")]),t._v(" "),s("ul",[s("li",[t._v("切片 "),s("code",[t._v("history[i:i+2]")]),t._v(" 不会报错：即使 "),s("code",[t._v("i+2")]),t._v(" 超出列表长度，也只会取到最后一个元素；")]),t._v(" "),s("li",[t._v("步长和分组大小可灵活调整：比如把 "),s("code",[t._v("2")]),t._v(" 改成 "),s("code",[t._v("3")]),t._v("，就是每 3 个元素为一组。")])]),t._v(" "),s("h3",{attrs:{id:"_2-isinstance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-isinstance"}},[t._v("#")]),t._v(" 2. isinstance")]),t._v(" "),s("p",[s("code",[t._v("isinstance()")]),t._v(" 是"),s("strong",[t._v("判断一个对象是否属于指定类型（或多个类型之一）")]),t._v(" 的内置函数，核心作用是做「类型检查」—— 确保变量的类型符合预期，避免因类型错误导致程序崩溃。")]),t._v(" "),s("h3",{attrs:{id:"一、isinstance-基本语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、isinstance-基本语法"}},[t._v("#")]),t._v(" 一、"),s("code",[t._v("isinstance()")]),t._v(" 基本语法")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("isinstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("对象"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 类型"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("类型元组"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("isinstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),s("ul",[s("li",[t._v("返回值："),s("strong",[t._v("布尔值")]),t._v("（"),s("code",[t._v("True")]),t._v(" 或 "),s("code",[t._v("False")]),t._v("）\n"),s("ul",[s("li",[t._v("若「对象」是「指定类型」（或多个类型之一），返回 "),s("code",[t._v("True")]),t._v("；")]),t._v(" "),s("li",[t._v("否则返回 "),s("code",[t._v("False")]),t._v("。")])])])]),t._v(" "),s("p",[t._v("isinstance(result, list):"),s("code",[t._v("的作用就是「判断变量")]),t._v("result` 是否为列表类型」, 核心价值是类型校验—— 确保后续代码（如遍历、索引取值）能安全执行，避免因类型不匹配导致的程序错误，尤其适合处理 API 返回、文件读取等不确定类型的场景。")]),t._v(" "),s("h3",{attrs:{id:"_3-if-name-in-parser-mapping"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-if-name-in-parser-mapping"}},[t._v("#")]),t._v(" 3. if name in PARSER_MAPPING")]),t._v(" "),s("p",[t._v("PARSER_MAPPING, 是一个字典")]),t._v(" "),s("h3",{attrs:{id:"_4-sys-argv-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-sys-argv-1"}},[t._v("#")]),t._v(" 4. sys.argv[1]")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n\nsys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv\n")])])]),s("p",[t._v("在 Python 中，"),s("code",[t._v("sys.argv")]),t._v(" 是用于"),s("strong",[t._v("获取命令行参数")]),t._v("的核心工具，相关属性的作用和使用场景如下，结合实例说明更易理解：")]),t._v(" "),s("h3",{attrs:{id:"_1-先明确核心背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-先明确核心背景"}},[t._v("#")]),t._v(" 1. 先明确核心背景")]),t._v(" "),s("p",[t._v("当你在 "),s("strong",[t._v("命令行（终端/CMD）")]),t._v(" 中运行 Python 脚本时，除了脚本文件名本身，还可以在后面跟额外的“参数”，这些参数会被 Python 捕获并存储在 "),s("code",[t._v("sys.argv")]),t._v(" 中，供脚本内部使用。")]),t._v(" "),s("p",[t._v("比如在命令行执行：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python test.py 张三 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("95.5")]),t._v("\n")])])]),s("p",[t._v("这里：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("python")]),t._v(" 是解释器命令")]),t._v(" "),s("li",[s("code",[t._v("test.py")]),t._v(" 是脚本文件名")]),t._v(" "),s("li",[s("code",[t._v("张三")]),t._v("、"),s("code",[t._v("20")]),t._v("、"),s("code",[t._v("95.5")]),t._v(" 是"),s("strong",[t._v("额外传入的命令行参数")]),t._v(" "),s("code",[t._v("sys.argv")]),t._v(" 会把这些信息统一存储起来。")])]),t._v(" "),s("p",[t._v("在命令行执行：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python test.py 张三 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("95.5")]),t._v("\n")])])]),s("h4",{attrs:{id:"输出结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出结果"}},[t._v("#")]),t._v(" 输出结果：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sys.argv 完整列表： ['test.py', '张三', '20', '95.5']\n脚本文件名： test.py\n额外参数个数： 3\n第一个额外参数（sys.argv[1]）： 张三\n第二个额外参数（sys.argv[2]）： 20  转换为整数： 20\n第三个额外参数（sys.argv[3]）： 95.5  转换为浮点数： 95.5\n")])])]),s("p",[t._v("总结："),s("code",[t._v("sys.argv")]),t._v(" 是 Python 脚本与命令行交互的基础，核心作用是“接收外部传入的参数”，"),s("code",[t._v("sys.argv[1:]")]),t._v(" （切片）可直接获取所有额外参数。")]),t._v(" "),s("h3",{attrs:{id:"requests-库的使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requests-库的使用"}},[t._v("#")]),t._v(" requests 库的使用")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n\nresponse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://restapi.amap.com/v3/geocode/regeo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" AMAP_MAPS_API_KEY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"location"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" location\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# requests.post")]),t._v("\nresponse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    DOUBAO_URL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    json"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    timeout"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("TIMEOUT\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"str-endswith-py"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#str-endswith-py"}},[t._v("#")]),t._v(" str.endswith('.py')")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("is_python "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" server_script_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("endswith"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.py'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"import-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import-module"}},[t._v("#")]),t._v(" import_module")]),t._v(" "),s("blockquote",[s("p",[t._v("import_module 的核心作用是 "),s("strong",[t._v("动态导入模块——")]),t._v(" 即运行时根据字符串指定的模块路径，动态加载对应的 Python 模块，返回模块对象。")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" importlib "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" import_module\n\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" import_module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'models.'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" model_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 动态导入的典型用法，目的是根据 model_name 变量，加载 models 包下对应的子模块，并使用该模块中的 Config 类：")]),t._v("\nconfig "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataset"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# eg: model_name = bert， 则读取的是：models/bert.py 文件，这个文件里，定义了 class Config(object):")]),t._v("\n")])])]),s("h3",{attrs:{id:"flask-框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flask-框架"}},[t._v("#")]),t._v(" Flask 框架")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" make_response\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask_socketio "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" SocketIO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" emit\n\nsocketio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SocketIO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cors_allowed_origins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" async_mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'threading'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JSON_AS_ASCII"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\nsocketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("init_app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("基于 Flask 框架搭建 Web 应用+WebSocket 实时通信服务")]),t._v(" 的核心初始化代码，主要作用是创建 Flask 应用实例、配置基础参数，并初始化支持跨域的 WebSocket 服务，让应用既能处理普通 HTTP 请求，又能实现客户端与服务器的实时双向通信。")]),t._v(" "),s("h3",{attrs:{id:"_1-导入依赖库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-导入依赖库"}},[t._v("#")]),t._v(" 1. 导入依赖库")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" make_response\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask_socketio "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" SocketIO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" emit\n")])])]),s("ul",[s("li",[s("code",[t._v("Flask")]),t._v("：创建 Web 应用的核心类（Flask 框架的入口）；")]),t._v(" "),s("li",[s("code",[t._v("jsonify")]),t._v("：快速将 Python 字典/数据转换成 JSON 格式的 HTTP 响应（方便接口返回 JSON 数据）；")]),t._v(" "),s("li",[s("code",[t._v("make_response")]),t._v("：自定义 HTTP 响应（比如设置响应头、状态码等）；")]),t._v(" "),s("li",[s("code",[t._v("SocketIO")]),t._v("：Flask 生态中支持 WebSocket 协议的扩展（负责实时通信）；")]),t._v(" "),s("li",[s("code",[t._v("emit")]),t._v("：WebSocket 中用于"),s("strong",[t._v("发送消息")]),t._v("的函数（服务器向客户端发消息，或客户端向服务器发消息）。")])]),t._v(" "),s("h3",{attrs:{id:"_2-初始化-websocket-实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-初始化-websocket-实例"}},[t._v("#")]),t._v(" 2. 初始化 WebSocket 实例")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("socketio "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SocketIO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cors_allowed_origins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" async_mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'threading'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("创建 WebSocket 服务实例，并配置两个关键参数：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("cors_allowed_origins='*'")]),t._v("：允许所有域名的客户端跨域连接（比如你的前端页面部署在 "),s("code",[t._v("http://localhost:8080")]),t._v("，后端 Flask 部署在 "),s("code",[t._v("http://localhost:5000")]),t._v("，跨域请求不会被浏览器拦截，开发阶段常用 "),s("code",[t._v("*")]),t._v(" 简化配置，生产环境建议指定具体域名）；")]),t._v(" "),s("li",[s("code",[t._v("async_mode='threading'")]),t._v("：指定 WebSocket 的异步模式为“线程模式”（Flask 原生是同步框架，通过线程处理并发的 WebSocket 连接，保证实时通信不阻塞其他请求，适合中小型应用）。")])]),t._v(" "),s("h3",{attrs:{id:"_3-初始化-flask-应用实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-初始化-flask-应用实例"}},[t._v("#")]),t._v(" 3. 初始化 Flask 应用实例")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("Flask(__name__)")]),t._v("：创建 Flask 应用核心对象 "),s("code",[t._v("app")]),t._v("；")]),t._v(" "),s("li",[s("code",[t._v("__name__")]),t._v(" 是 Python 的内置变量，代表当前模块名，Flask 会通过它定位应用的根目录（比如查找静态文件、模板文件的路径）。")])]),t._v(" "),s("h3",{attrs:{id:"_4-配置-flask-应用参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置-flask-应用参数"}},[t._v("#")]),t._v(" 4. 配置 Flask 应用参数")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JSON_AS_ASCII"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n")])])]),s("ul",[s("li",[t._v("关闭 JSON 响应的 ASCII 编码限制（默认情况下，"),s("code",[t._v("jsonify")]),t._v(" 会把中文等非 ASCII 字符转换成 "),s("code",[t._v("\\uXXXX")]),t._v(" 格式，设置为 "),s("code",[t._v("False")]),t._v(" 后，会直接返回中文原文，方便前端显示）。")])]),t._v(" "),s("h3",{attrs:{id:"_5-关联-websocket-与-flask-应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-关联-websocket-与-flask-应用"}},[t._v("#")]),t._v(" 5. 关联 WebSocket 与 Flask 应用")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("init_app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("将之前创建的 WebSocket 实例 "),s("code",[t._v("socketio")]),t._v(" 与 Flask 应用 "),s("code",[t._v("app")]),t._v(" 绑定，让 Flask 应用同时支持：\n"),s("ol",[s("li",[t._v("普通 HTTP 接口（比如 "),s("code",[t._v("@app.route('/api/data')")]),t._v(" 定义的接口）；")]),t._v(" "),s("li",[t._v("WebSocket 实时通信（比如客户端通过 "),s("code",[t._v("ws://xxx")]),t._v(" 连接服务器，实现消息推送、实时聊天等）。")])])])]),t._v(" "),s("h3",{attrs:{id:"这段代码的典型使用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#这段代码的典型使用场景"}},[t._v("#")]),t._v(" 这段代码的典型使用场景")]),t._v(" "),s("p",[t._v("有了这些初始化后，你可以：")]),t._v(" "),s("ol",[s("li",[t._v("写普通 HTTP 接口（比如查询数据）："),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api/get_user'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"age"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 中文正常显示")]),t._v("\n")])])])]),t._v(" "),s("li",[t._v("写 WebSocket 实时通信逻辑（比如服务器向客户端推送消息、客户端之间聊天）："),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 客户端连接 WebSocket 时触发")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'connect'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handle_connect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"有客户端连接成功！"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    emit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'welcome'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'欢迎加入实时通信！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 向连接的客户端发消息")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 接收客户端发送的"chat_message"类型消息')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'chat_message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handle_chat_message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"收到消息：')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("emit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'broadcast_message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 向所有连接的客户端广播消息")]),t._v("\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("这段代码是一个 "),s("strong",[t._v("支持跨域、支持 JSON 中文显示、同时具备 HTTP 接口和 WebSocket 实时通信能力")]),t._v(" 的 Flask 应用基础骨架。")]),t._v(" "),s("p",[t._v("后续只需：")]),t._v(" "),s("ul",[s("li",[t._v("用 "),s("code",[t._v("@app.route")]),t._v(" 定义 HTTP 接口；")]),t._v(" "),s("li",[t._v("用 "),s("code",[t._v("@socketio.on")]),t._v(" 定义 WebSocket 消息处理逻辑；")]),t._v(" "),s("li",[t._v("运行 "),s("code",[t._v("socketio.run(app, debug=True)")]),t._v(" 启动服务，即可实现普通接口调用和实时消息交互（比如聊天、实时数据推送等场景）。")])]),t._v(" "),s("h3",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[t._v("#")]),t._v(" usage")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/health"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("check")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" make_response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("health"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"healthy"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response\n")])])]),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'connect'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("connected_msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    manager "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("manager\n    connections_count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rooms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'当前连接数: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("connections_count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'client connected.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h4",{attrs:{id:"启动服务-socketio-run-app-debug-true"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动服务-socketio-run-app-debug-true"}},[t._v("#")]),t._v(" 启动服务：socketio.run(app, debug=True)")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    socketio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        allow_unsafe_werkzeug"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        host"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0.0.0.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FLASK_SERVER_PORT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"traceback-print-exc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#traceback-print-exc"}},[t._v("#")]),t._v(" traceback.print_exc()")]),t._v(" "),s("blockquote",[s("p",[t._v("用 "),s("code",[t._v("traceback.print_exc()")]),t._v(" 会输出 完整的错误追踪栈")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" traceback\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" Exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"出错了："')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    traceback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print_exc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印完整错误信息")]),t._v("\n")])])]),s("h3",{attrs:{id:"输出结果-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出结果-2"}},[t._v("#")]),t._v(" 输出结果")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('出错了：\nTraceback (most recent call last):\n  File "test.py", line 4, in &lt;module>\n    10 / 0\nZeroDivisionError: division by zero\n')])])])])}),[],!1,null,null,null);s.default=e.exports}}]);