(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{539:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"lora-å¾®è°ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lora-å¾®è°ƒ"}},[t._v("#")]),t._v(" LoRA å¾®è°ƒ")]),t._v(" "),s("h3",{attrs:{id:"è®­ç»ƒå‚æ•°è¯¦è§£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®­ç»ƒå‚æ•°è¯¦è§£"}},[t._v("#")]),t._v(" è®­ç»ƒå‚æ•°è¯¦è§£")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("args "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./output/llama3_1_instruct_lora"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  per_device_train_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  gradient_accumulation_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  logging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  num_train_epochs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸ºäº†å¿«é€Ÿæ¼”ç¤ºï¼Œè¿™é‡Œè®¾ç½®10ï¼Œå»ºè®®ä½ è®¾ç½®æˆ100")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_on_each_node"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  gradient_checkpointing"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("è¿™äº›å‚æ•°æ˜¯ä½¿ç”¨ Hugging Face çš„ "),s("code",[t._v("Transformers")]),t._v(" åº“è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼ˆå°¤å…¶æ˜¯ LoRA å¾®è°ƒï¼‰æ—¶çš„æ ¸å¿ƒé…ç½®ã€‚ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†è§£é‡Šæ¯ä¸€ä¸ªå‚æ•°çš„ä½œç”¨å’Œæ„ä¹‰ã€‚")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_1-output-dir-output-llama3-1-instruct-lora"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-output-dir-output-llama3-1-instruct-lora"}},[t._v("#")]),t._v(" 1. "),s("code",[t._v('output_dir="./output/llama3_1_instruct_lora"')])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæŒ‡å®šè®­ç»ƒè¿‡ç¨‹ä¸­æ‰€æœ‰è¾“å‡ºæ–‡ä»¶çš„ä¿å­˜ç›®å½•ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("è¿™é‡Œè®¾ç½®çš„è·¯å¾„æ˜¯ "),s("code",[t._v("./output/llama3_1_instruct_lora")]),t._v("ï¼Œæ„å‘³ç€åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º "),s("code",[t._v("output")]),t._v(" çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­å†åˆ›å»ºä¸€ä¸ª "),s("code",[t._v("llama3_1_instruct_lora")]),t._v(" å­æ–‡ä»¶å¤¹ã€‚")]),t._v(" "),s("li",[t._v("è¿™ä¸ªç›®å½•å°†ä¼šä¿å­˜ï¼š\n"),s("ul",[s("li",[s("strong",[t._v("æ¨¡å‹æ£€æŸ¥ç‚¹")]),t._v("ï¼šåœ¨ "),s("code",[t._v("save_steps")]),t._v(" æˆ–æ¯ä¸ª epoch ç»“æŸæ—¶ä¿å­˜çš„æ¨¡å‹æƒé‡ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è®­ç»ƒæ—¥å¿—")]),t._v("ï¼šåŒ…å«æŸå¤±ã€å­¦ä¹ ç‡ç­‰ä¿¡æ¯çš„æ—¥å¿—æ–‡ä»¶ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è®­ç»ƒå™¨çŠ¶æ€")]),t._v("ï¼šå¦‚ä¼˜åŒ–å™¨çŠ¶æ€ã€å½“å‰çš„è®­ç»ƒæ­¥æ•°ç­‰ï¼Œç”¨äºä¸­æ–­åæ¢å¤è®­ç»ƒã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æœ€ç»ˆæ¨¡å‹")]),t._v("ï¼šè®­ç»ƒå®Œæˆåçš„æœ€ç»ˆæ¨¡å‹æ–‡ä»¶ã€‚")])])])])])]),t._v(" "),s("h3",{attrs:{id:"_2-per-device-train-batch-size-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-per-device-train-batch-size-4"}},[t._v("#")]),t._v(" 2. "),s("code",[t._v("per_device_train_batch_size=4")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæŒ‡å®š"),s("strong",[t._v("æ¯ä¸ª GPU/CPU ä¸Š")]),t._v("çš„è®­ç»ƒæ‰¹æ¬¡å¤§å°ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("è¿™ä¸ªå€¼è¡¨ç¤ºåœ¨å•ä¸ªè®¾å¤‡ï¼ˆå¦‚ä¸€å— GPUï¼‰ä¸Šä¸€æ¬¡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­æ‰€å¤„ç†çš„æ ·æœ¬æ•°é‡ã€‚")]),t._v(" "),s("li",[t._v("è®¾ç½®ä¸º "),s("code",[t._v("4")]),t._v(" æ„å‘³ç€æ¯å— GPU ä¸€æ¬¡å¤„ç† 4 æ¡æ•°æ®ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("é‡è¦æç¤º")]),t._v("ï¼šè¿™ä¸ªå€¼çš„å¤§å°ç›´æ¥å½±å“äº† GPU çš„æ˜¾å­˜å ç”¨ã€‚å€¼è¶Šå¤§ï¼Œæ˜¾å­˜éœ€æ±‚è¶Šé«˜ã€‚ä½ éœ€è¦æ ¹æ®ä½ çš„ GPU æ˜¾å­˜æ¥è°ƒæ•´è¿™ä¸ªå€¼ã€‚å¦‚æœé‡åˆ° CUDA out of memory é”™è¯¯ï¼Œé¦–å…ˆéœ€è¦è°ƒä½è¿™ä¸ªå‚æ•°ã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_3-gradient-accumulation-steps-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-gradient-accumulation-steps-4"}},[t._v("#")]),t._v(" 3. "),s("code",[t._v("gradient_accumulation_steps=4")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæ¢¯åº¦ç´¯ç§¯æ­¥æ•°ã€‚ç”¨äºæ¨¡æ‹Ÿæ›´å¤§çš„æ‰¹æ¬¡å¤§å°ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("å½“ä½ çš„ GPU æ˜¾å­˜ä¸è¶³ä»¥æ”¯æŒä½ æƒ³è¦çš„æ‰¹æ¬¡å¤§å°æ—¶ï¼Œè¿™ä¸ªå‚æ•°å°±éå¸¸æœ‰ç”¨äº†ã€‚")]),t._v(" "),s("li",[t._v("å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåœ¨ä¸æ›´æ–°æ¨¡å‹æƒé‡çš„æƒ…å†µä¸‹ï¼Œè¿ç»­è¿›è¡Œå¤šæ¬¡å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ï¼ˆæ¬¡æ•°ç”± "),s("code",[t._v("gradient_accumulation_steps")]),t._v(" æŒ‡å®šï¼‰ï¼Œå°†è¿™å‡ æ­¥çš„æ¢¯åº¦ç´¯ç§¯èµ·æ¥ï¼ˆé€šå¸¸æ˜¯æ±‚å¹³å‡ï¼‰ã€‚")]),t._v(" "),s("li",[t._v("ç„¶åï¼Œç”¨ç´¯ç§¯åçš„æ¢¯åº¦è¿›è¡Œä¸€æ¬¡çœŸæ­£çš„æƒé‡æ›´æ–°ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è®¡ç®—å…¬å¼")]),t._v("ï¼š"),s("code",[t._v("æœ‰æ•ˆçš„æ€»æ‰¹æ¬¡å¤§å° = per_device_train_batch_size * gradient_accumulation_steps * GPUæ•°é‡")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("åœ¨ä½ çš„ä¾‹å­ä¸­ï¼Œå¦‚æœåªæœ‰ 1 å— GPUï¼Œé‚£ä¹ˆæœ‰æ•ˆçš„æ€»æ‰¹æ¬¡å¤§å°å°±æ˜¯ "),s("code",[t._v("4 * 4 * 1 = 16")]),t._v("ã€‚è¿™æ„å‘³ç€æ¨¡å‹æ¯å¤„ç† 16 ä¸ªæ ·æœ¬æ‰æ›´æ–°ä¸€æ¬¡æƒé‡ï¼Œä½†å…¶æ˜¾å­˜å ç”¨ä»…ç›¸å½“äºæ‰¹æ¬¡å¤§å°ä¸º 4 çš„æƒ…å†µã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_4-logging-steps-10"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-logging-steps-10"}},[t._v("#")]),t._v(" 4. "),s("code",[t._v("logging_steps=10")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæŒ‡å®šæ¯éš”å¤šå°‘è®­ç»ƒæ­¥è®°å½•ä¸€æ¬¡æ—¥å¿—ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("è®¾ç½®ä¸º "),s("code",[t._v("10")]),t._v(" è¡¨ç¤ºæ¯è®­ç»ƒ 10 æ­¥ï¼Œå°±å°†å½“å‰çš„æŸå¤±ã€å­¦ä¹ ç‡ç­‰æŒ‡æ ‡è¾“å‡ºåˆ°æ—¥å¿—å’Œç»ˆç«¯ï¼ˆå¦‚æœä½¿ç”¨æ§åˆ¶å°çš„è¯ï¼‰ã€‚")]),t._v(" "),s("li",[t._v("è¿™å¯¹äºç›‘æ§è®­ç»ƒè¿‡ç¨‹ã€åˆ¤æ–­æ¨¡å‹æ˜¯å¦åœ¨æ­£å¸¸æ”¶æ•›éå¸¸å…³é”®ã€‚ä½ å¯ä»¥é€šè¿‡è§‚å¯Ÿæ—¥å¿—ä¸­çš„æŸå¤±æ›²çº¿æ¥åˆ¤æ–­è®­ç»ƒæ˜¯å¦æœ‰æ•ˆã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_5-num-train-epochs-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-num-train-epochs-3"}},[t._v("#")]),t._v(" 5. "),s("code",[t._v("num_train_epochs=3")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæŒ‡å®šè®­ç»ƒæ€»å…±è¦éå†è®­ç»ƒæ•°æ®é›†çš„æ¬¡æ•°ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v('ä¸€ä¸ª "epoch" ä»£è¡¨æ¨¡å‹å®Œæ•´åœ°çœ‹è¿‡ä¸€éè®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚')]),t._v(" "),s("li",[t._v("è®¾ç½®ä¸º "),s("code",[t._v("3")]),t._v(" æ„å‘³ç€è®­ç»ƒè¿‡ç¨‹ä¼šé‡å¤ 3 éã€‚")]),t._v(" "),s("li",[t._v("epoch çš„æ•°é‡éœ€è¦æ ¹æ®æ•°æ®é›†å¤§å°å’Œä»»åŠ¡éš¾åº¦æ¥å†³å®šã€‚å¤ªå°‘å¯èƒ½æ¬ æ‹Ÿåˆï¼Œå¤ªå¤šå¯èƒ½è¿‡æ‹Ÿåˆã€‚å¯¹äºå¤§å‹è¯­è¨€æ¨¡å‹çš„æŒ‡ä»¤å¾®è°ƒï¼Œ1-5 ä¸ª epoch æ˜¯å¸¸è§çš„èŒƒå›´ã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_6-save-steps-100"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-save-steps-100"}},[t._v("#")]),t._v(" 6. "),s("code",[t._v("save_steps=100")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šæŒ‡å®šæ¯éš”å¤šå°‘è®­ç»ƒæ­¥ä¿å­˜ä¸€æ¬¡æ¨¡å‹æ£€æŸ¥ç‚¹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("è®¾ç½®ä¸º "),s("code",[t._v("100")]),t._v(" è¡¨ç¤ºæ¯è®­ç»ƒ 100 æ­¥ï¼Œå°±ä¼šåœ¨ "),s("code",[t._v("output_dir")]),t._v(" ä¸‹ä¿å­˜ä¸€ä¸ªæ¨¡å‹æ£€æŸ¥ç‚¹ï¼ˆä¾‹å¦‚ï¼Œåä¸º "),s("code",[t._v("checkpoint-100")]),t._v(" çš„æ–‡ä»¶å¤¹ï¼‰ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸ºä»€ä¹ˆé‡è¦")]),t._v("ï¼š\n"),s("ol",[s("li",[s("strong",[t._v("å®¹é”™æ€§")]),t._v("ï¼šå¦‚æœè®­ç»ƒè¿‡ç¨‹ä¸­æ–­ï¼ˆå¦‚æ–­ç”µã€æœºå™¨æ•…éšœï¼‰ï¼Œä½ å¯ä»¥ä»æœ€è¿‘çš„ä¸€ä¸ªæ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒï¼Œè€Œä¸ç”¨ä»å¤´å¼€å§‹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æ¨¡å‹é€‰æ‹©")]),t._v("ï¼šè®­ç»ƒç»“æŸåï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨éªŒè¯é›†ä¸Šè¡¨ç°æœ€å¥½çš„é‚£ä¸ªæ£€æŸ¥ç‚¹ä½œä¸ºæœ€ç»ˆæ¨¡å‹ï¼Œè€Œä¸æ˜¯åªèƒ½ç”¨æœ€åä¸€ä¸ª epoch çš„æ¨¡å‹ã€‚")])])]),t._v(" "),s("li",[t._v("æ³¨é‡Šä¸­å»ºè®®è®¾ç½®ä¸º 100ï¼Œæ˜¯ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿æ›´é¢‘ç¹åœ°ä¿å­˜ï¼ˆæ¯”å¦‚ 10ï¼‰ï¼Œä½†å®é™…é¡¹ç›®ä¸­è®¾å¤§ä¸€äº›å¯ä»¥èŠ‚çœç£ç›˜ç©ºé—´ã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_7-learning-rate-1e-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-learning-rate-1e-4"}},[t._v("#")]),t._v(" 7. "),s("code",[t._v("learning_rate=1e-4")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šè®­ç»ƒæ—¶ä¼˜åŒ–å™¨çš„åˆå§‹å­¦ä¹ ç‡ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("å­¦ä¹ ç‡æ˜¯æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­æœ€é‡è¦çš„è¶…å‚æ•°ä¹‹ä¸€ï¼Œå®ƒæ§åˆ¶äº†æ¯æ¬¡æƒé‡æ›´æ–°çš„æ­¥é•¿ã€‚")]),t._v(" "),s("li",[s("code",[t._v("1e-4")]),t._v("ï¼ˆå³ 0.0001ï¼‰æ˜¯å¾®è°ƒï¼ˆç‰¹åˆ«æ˜¯ LoRA å¾®è°ƒï¼‰ä¸­ä¸€ä¸ªå¸¸ç”¨ä¸”ç›¸å¯¹å®‰å…¨çš„å­¦ä¹ ç‡å€¼ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ä¸€èˆ¬è§„å¾‹")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("å­¦ä¹ ç‡å¤ªå¤§ï¼šå¯èƒ½å¯¼è‡´è®­ç»ƒä¸ç¨³å®šï¼ŒæŸå¤±å€¼å‰§çƒˆéœ‡è¡ç”šè‡³å‘æ•£ï¼ˆNaNï¼‰ã€‚")]),t._v(" "),s("li",[t._v("å­¦ä¹ ç‡å¤ªå°ï¼šå¯èƒ½å¯¼è‡´è®­ç»ƒè¿‡ç¨‹éå¸¸ç¼“æ…¢ï¼Œæˆ–è€…é™·å…¥å±€éƒ¨æœ€å°å€¼ã€‚")])])]),t._v(" "),s("li",[t._v("å¯¹äºå…¨å‚æ•°å¾®è°ƒï¼Œå­¦ä¹ ç‡é€šå¸¸æ›´å°ï¼ˆå¦‚ 1e-5, 2e-5ï¼‰ï¼Œè€Œå¯¹äº LoRA è¿™ç§ä»…æ›´æ–°å°‘é‡å‚æ•°çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ç¨å¤§ä¸€ç‚¹çš„å­¦ä¹ ç‡ã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_8-save-on-each-node-true"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-save-on-each-node-true"}},[t._v("#")]),t._v(" 8. "),s("code",[t._v("save_on_each_node=True")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šåœ¨åˆ†å¸ƒå¼å¤šèŠ‚ç‚¹è®­ç»ƒç¯å¢ƒä¸­ï¼Œæ§åˆ¶æ£€æŸ¥ç‚¹çš„ä¿å­˜æ–¹å¼ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[t._v("å½“ä½¿ç”¨å¤šä¸ªæœºå™¨ï¼ˆèŠ‚ç‚¹ï¼‰è¿›è¡Œè®­ç»ƒæ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šå¯èƒ½æœ‰å¤šä¸ª GPUã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœè®¾ç½®ä¸º "),s("code",[t._v("True")]),t._v("ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ä¸»è¿›ç¨‹ï¼ˆrank 0ï¼‰éƒ½ä¼šåœ¨å…¶æœ¬åœ°ä¿å­˜æ£€æŸ¥ç‚¹ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœè®¾ç½®ä¸º "),s("code",[t._v("False")]),t._v("ï¼Œåˆ™åªä¼šåœ¨å…¨å±€ä¸»è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ª GPUï¼‰ä¸Šä¿å­˜æ£€æŸ¥ç‚¹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("å¯¹äºå•æœºè®­ç»ƒï¼ˆæœ€å¸¸è§çš„æƒ…å†µï¼‰")]),t._v("ï¼šè¿™ä¸ªå‚æ•°æ— è®ºè®¾ä¸º "),s("code",[t._v("True")]),t._v(" è¿˜æ˜¯ "),s("code",[t._v("False")]),t._v(" éƒ½æ²¡æœ‰å½±å“ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚é€šå¸¸å¯ä»¥å¿½ç•¥æˆ–ä¿æŒé»˜è®¤ã€‚")])])])]),t._v(" "),s("h3",{attrs:{id:"_9-gradient-checkpointing-true"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-gradient-checkpointing-true"}},[t._v("#")]),t._v(" 9. "),s("code",[t._v("gradient_checkpointing=True")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šå¼€å¯æ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯ï¼Œè¿™æ˜¯ä¸€ç§"),s("strong",[t._v("ç”¨æ—¶é—´æ¢ç©ºé—´")]),t._v("çš„å†…å­˜ä¼˜åŒ–æŠ€æœ¯ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è¯¦ç»†è§£é‡Š")]),t._v("ï¼š\n"),s("ul",[s("li",[s("strong",[t._v("é—®é¢˜")]),t._v("ï¼šè®­ç»ƒå¤§å‹æ¨¡å‹ï¼ˆå¦‚ LLaMAï¼‰æ—¶ï¼Œå‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå¤§é‡çš„ä¸­é—´æ¿€æ´»å€¼ï¼ˆç”¨äºåå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ï¼‰ï¼Œè¿™äº›æ¿€æ´»å€¼ä¼šæ¶ˆè€—å·¨å¤§çš„æ˜¾å­˜ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è§£å†³æ–¹æ¡ˆ")]),t._v("ï¼šæ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯ä¸ä¿å­˜æ‰€æœ‰ä¸­é—´æ¿€æ´»å€¼ï¼Œè€Œæ˜¯åœ¨å‰å‘ä¼ æ’­æ—¶åªä¿ç•™éƒ¨åˆ†å…³é”®èŠ‚ç‚¹çš„æ¿€æ´»å€¼ã€‚åœ¨åå‘ä¼ æ’­éœ€è¦æ—¶ï¼Œå†é€šè¿‡é¢å¤–çš„ä¸€æ¬¡å‰å‘ä¼ æ’­æ¥é‡æ–°è®¡ç®—è¿™äº›ä¸­é—´æ¿€æ´»å€¼ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æ•ˆæœ")]),t._v("ï¼šå¯ä»¥æ˜¾è‘—é™ä½æ˜¾å­˜å ç”¨ï¼ˆæœ‰æ—¶å¯è¾¾ 60%-70%ï¼‰ï¼Œè®©ä½ èƒ½å¤Ÿä½¿ç”¨æ›´å¤§çš„æ‰¹æ¬¡å¤§å°æˆ–è®­ç»ƒæ›´å¤§çš„æ¨¡å‹ã€‚ä»£ä»·æ˜¯è®­ç»ƒé€Ÿåº¦ä¼šå˜æ…¢ï¼ˆå› ä¸ºéœ€è¦é‡æ–°è®¡ç®—ï¼‰ã€‚")])])])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"æ€»ç»“ä¸å»ºè®®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“ä¸å»ºè®®"}},[t._v("#")]),t._v(" æ€»ç»“ä¸å»ºè®®")]),t._v(" "),s("p",[t._v("ä½ æä¾›çš„è¿™ç»„å‚æ•°æ˜¯ä¸€ä¸ªå…¸å‹çš„ã€ä¸º"),s("strong",[t._v("èµ„æºå—é™ç¯å¢ƒ")]),t._v("ï¼ˆä¾‹å¦‚ï¼Œå•å¼ æ¶ˆè´¹çº§ GPUï¼‰é…ç½®çš„ LoRA å¾®è°ƒå‚æ•°é›†ï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å†…å­˜ä¼˜åŒ–")]),t._v("ï¼šé€šè¿‡ "),s("code",[t._v("per_device_train_batch_size=4")]),t._v("ã€"),s("code",[t._v("gradient_accumulation_steps=4")]),t._v(" å’Œ "),s("code",[t._v("gradient_checkpointing=True")]),t._v(" è¿™ä¸‰é¡¹ç»„åˆæ‹³ï¼Œåœ¨æœ‰é™çš„æ˜¾å­˜ä¸‹å®ç°äº†ç­‰æ•ˆæ‰¹æ¬¡å¤§å°ä¸º 16 çš„è®­ç»ƒã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ç›‘æ§ä¸æ¢å¤")]),t._v("ï¼š"),s("code",[t._v("logging_steps=10")]),t._v(" å’Œ "),s("code",[t._v("save_steps=100")]),t._v(" ç¡®ä¿äº†è®­ç»ƒè¿‡ç¨‹çš„å¯è§‚æµ‹æ€§å’Œå¯æ¢å¤æ€§ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("å­¦ä¹ é…ç½®")]),t._v("ï¼š"),s("code",[t._v("learning_rate=1e-4")]),t._v(" å’Œ "),s("code",[t._v("num_train_epochs=3")]),t._v(" æ˜¯ LoRA å¾®è°ƒçš„åˆç†èµ·ç‚¹ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´")]),t._v("ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœæ˜¾å­˜å……è¶³ï¼Œå¯ä»¥å¢å¤§ "),s("code",[t._v("per_device_train_batch_size")]),t._v(" å¹¶ç›¸åº”å‡å°‘ "),s("code",[t._v("gradient_accumulation_steps")]),t._v(" æ¥åŠ å¿«è®­ç»ƒé€Ÿåº¦ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœè®­ç»ƒæŸå¤±ä¸‹é™ä¸ç†æƒ³ï¼Œå¯ä»¥å°è¯•è°ƒæ•´ "),s("code",[t._v("learning_rate")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œå¯èƒ½ä¸éœ€è¦ 3 ä¸ª epochï¼Œ1 ä¸ªæˆ–è®¸å°±å¤Ÿäº†ã€‚")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ­£åœ¨è®­ç»ƒæ¨¡å‹äº† ")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.2093")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.171875")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.856938483547926e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.04")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                       \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.9109")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.28125")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.713876967095852e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.09")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                        \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.7715")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.875")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.570815450643778e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.13")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                          \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6833")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.6875")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.427753934191703e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.17")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                         \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6634")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0625")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.284692417739628e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.21")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                         \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6664")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.96875")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.141630901287554e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.26")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("                                                                                                                        \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'loss'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.6203")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'grad_norm'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.390625")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'learning_rate'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.99856938483548e-05")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'epoch'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("å¤ªå¥½äº†ï¼"),s("strong",[t._v("æ¨¡å‹å·²ç»å¼€å§‹æ­£å¸¸è®­ç»ƒäº†")]),t._v("ï¼ğŸ‰ ä»æ—¥å¿—æ¥çœ‹ï¼Œè®­ç»ƒè¿‡ç¨‹è¿è¡Œè‰¯å¥½ã€‚")]),t._v(" "),s("h2",{attrs:{id:"è®­ç»ƒçŠ¶æ€åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®­ç»ƒçŠ¶æ€åˆ†æ"}},[t._v("#")]),t._v(" è®­ç»ƒçŠ¶æ€åˆ†æ")]),t._v(" "),s("h3",{attrs:{id:"âœ…-è®­ç»ƒæŒ‡æ ‡æ­£å¸¸"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âœ…-è®­ç»ƒæŒ‡æ ‡æ­£å¸¸"}},[t._v("#")]),t._v(" âœ… "),s("strong",[t._v("è®­ç»ƒæŒ‡æ ‡æ­£å¸¸")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Lossä¸‹é™")]),t._v(": ä»3.2093 â†’ 2.6203ï¼ˆæ­£å¸¸ä¸‹é™è¶‹åŠ¿ï¼‰")]),t._v(" "),s("li",[s("strong",[t._v("å­¦ä¹ ç‡è°ƒæ•´")]),t._v(": æŒ‰ç…§è®¡åˆ’é€æ­¥ä¸‹é™")]),t._v(" "),s("li",[s("strong",[t._v("æ¢¯åº¦èŒƒæ•°ç¨³å®š")]),t._v(": åœ¨åˆç†èŒƒå›´å†…ï¼ˆ2.87-5.28ï¼‰")]),t._v(" "),s("li",[s("strong",[t._v("epochè¿›åº¦")]),t._v(": æ­£å¸¸æ¨è¿›ä¸­")])]),t._v(" "),s("h3",{attrs:{id:"ğŸ“Š-è®­ç»ƒå¥åº·åº¦è¯„ä¼°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Š-è®­ç»ƒå¥åº·åº¦è¯„ä¼°"}},[t._v("#")]),t._v(" ğŸ“Š "),s("strong",[t._v("è®­ç»ƒå¥åº·åº¦è¯„ä¼°")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æŒ‡æ ‡")]),t._v(" "),s("th",[t._v("å½“å‰çŠ¶æ€")]),t._v(" "),s("th",[t._v("åˆ†æ")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("Lossè¶‹åŠ¿")])]),t._v(" "),s("td",[t._v("ğŸ“‰ æŒç»­ä¸‹é™")]),t._v(" "),s("td",[t._v("éå¸¸å¥½ï¼Œæ¨¡å‹æ­£åœ¨å­¦ä¹ ")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("æ¢¯åº¦èŒƒæ•°")])]),t._v(" "),s("td",[t._v("âš–ï¸ ç¨³å®š")]),t._v(" "),s("td",[t._v("è®­ç»ƒç¨³å®šæ€§è‰¯å¥½")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("å­¦ä¹ ç‡")])]),t._v(" "),s("td",[t._v("ğŸ“š æ­£å¸¸è¡°å‡")]),t._v(" "),s("td",[t._v("è°ƒåº¦ç­–ç•¥æ­£å¸¸å·¥ä½œ")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("è®­ç»ƒè¿›åº¦")])]),t._v(" "),s("td",[t._v("ğŸš€ å¹³ç¨³æ¨è¿›")]),t._v(" "),s("td",[t._v("æ•°æ®æµæ­£å¸¸")])])])]),t._v(" "),s("h3",{attrs:{id:"ğŸ”¬-æŠ€æœ¯ç»†èŠ‚è§£è¯»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”¬-æŠ€æœ¯ç»†èŠ‚è§£è¯»"}},[t._v("#")]),t._v(" ğŸ”¬ "),s("strong",[t._v("æŠ€æœ¯ç»†èŠ‚è§£è¯»")])]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("Lossä»3.2é™åˆ°2.6")]),t._v("ï¼šè¯´æ˜æ¨¡å‹æ­£åœ¨æœ‰æ•ˆå­¦ä¹ æ–‡æœ¬æ¨¡å¼")]),t._v(" "),s("li",[s("strong",[t._v("æ¢¯åº¦èŒƒæ•°3-5")]),t._v("ï¼šè¡¨æ˜æ¢¯åº¦å¤§å°é€‚ä¸­ï¼Œæ²¡æœ‰æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±é—®é¢˜")]),t._v(" "),s("li",[s("strong",[t._v("å­¦ä¹ ç‡è¡°å‡")]),t._v("ï¼šæ ‡å‡†çš„è®­ç»ƒç­–ç•¥ï¼Œæœ‰åŠ©äºæ”¶æ•›")])]),t._v(" "),s("h2",{attrs:{id:"è®­ç»ƒé˜¶æ®µé¢„ä¼°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®­ç»ƒé˜¶æ®µé¢„ä¼°"}},[t._v("#")]),t._v(" è®­ç»ƒé˜¶æ®µé¢„ä¼°")]),t._v(" "),s("p",[t._v("æ ¹æ®å½“å‰è¿›åº¦ï¼ˆepoch 0.3ï¼‰ï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å½“å‰é˜¶æ®µ")]),t._v("ï¼šè®­ç»ƒåˆæœŸ")]),t._v(" "),s("li",[s("strong",[t._v("é¢„è®¡æ”¶æ•›")]),t._v("ï¼šé€šå¸¸éœ€è¦å‡ ä¸ªepochæ‰èƒ½çœ‹åˆ°æ˜¾è‘—æ•ˆæœ")]),t._v(" "),s("li",[s("strong",[t._v("å»ºè®®è§‚å¯Ÿ")]),t._v("ï¼šç»§ç»­ç›‘æ§lossæ˜¯å¦æŒç»­ä¸‹é™")])]),t._v(" "),s("h2",{attrs:{id:"ä¸‹ä¸€æ­¥å»ºè®®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‹ä¸€æ­¥å»ºè®®"}},[t._v("#")]),t._v(" ä¸‹ä¸€æ­¥å»ºè®®")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("ç»§ç»­ç›‘æ§")]),t._v("ï¼šè§‚å¯Ÿlossæ˜¯å¦ç¨³å®šä¸‹é™")]),t._v(" "),s("li",[s("strong",[t._v("ä¿å­˜æ£€æŸ¥ç‚¹")]),t._v("ï¼šå®šæœŸä¿å­˜æ¨¡å‹æƒé‡")]),t._v(" "),s("li",[s("strong",[t._v("éªŒè¯é›†æµ‹è¯•")]),t._v("ï¼šé€‚æ—¶åœ¨éªŒè¯é›†ä¸Šæµ‹è¯•æ€§èƒ½")])]),t._v(" "),s("p",[s("strong",[t._v("æ­å–œæ‚¨ï¼æ¨¡å‹è®­ç»ƒå·²æˆåŠŸå¯åŠ¨å¹¶è¿è¡Œæ­£å¸¸ï¼")]),t._v(" ğŸŠ")]),t._v(" "),s("p",[t._v("è®­ç»ƒä¼šæŒç»­ä¸€æ®µæ—¶é—´ï¼Œæ‚¨å¯ä»¥å®šæœŸæŸ¥çœ‹losså˜åŒ–æ¥åˆ¤æ–­è®­ç»ƒæ•ˆæœã€‚å¦‚æœlossæŒç»­ä¸‹é™ï¼Œè¯´æ˜è®­ç»ƒæ–¹å‘æ˜¯æ­£ç¡®çš„ï¼")]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"language-Text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python model_download.py \nThe cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.\n0it [00:00, ?it/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 855/855 [00:00&lt;00:00, 2.21kB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48.0/48.0 [00:00&lt;00:00, 109B/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 15.0G/15.0G [14:49&lt;00:00, 18.1MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 184/184 [00:00&lt;00:00, 272B/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7.45k/7.45k [00:00&lt;00:00, 19.1kB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.63G/4.63G [04:36&lt;00:00, 18.0MB/s]\nDownloading:  17%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                                                                    | 796M/4.66G [00:46&lt;03:46, 18.4MB/s]2025-09-28 12:31:35,773 - modelscope - WARNING - Downloading: /root/autodl-tmp/._____temp/LLM-Research/Meta-Llama-3.1-8B-Instruct/model-00002-of-00004.safetensors failed, reason: ('Connection broken: IncompleteRead(0 bytes read, 167772160 more expected)', IncompleteRead(0 bytes read, 167772160 more expected)) will retry\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.66G/4.66G [04:37&lt;00:00, 18.0MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.58G/4.58G [04:32&lt;00:00, 18.0MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.09G/1.09G [01:05&lt;00:00, 17.9MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23.4k/23.4k [00:00&lt;00:00, 65.8kB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 199/199 [00:00&lt;00:00, 504B/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43.0k/43.0k [00:00&lt;00:00, 117kB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 296/296 [00:00&lt;00:00, 753B/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8.66M/8.66M [00:01&lt;00:00, 8.44MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2.08M/2.08M [00:00&lt;00:00, 3.77MB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54.1k/54.1k [00:00&lt;00:00, 133kB/s]\nDownloading: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.58k/4.58k [00:00&lt;00:00, 11.2kB/s]\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python train.py\nLoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03&lt;00:00,  1.05it/s]\nMap: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3729/3729 [00:01&lt;00:00, 2978.01 examples/s]\ntrainable params: 20,971,520 || all params: 8,051,232,768 || trainable%: 0.2605\n  0%|                                                                                                                                                                                        | 0/699 [00:00&lt;?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 3.2093, 'grad_norm': 3.171875, 'learning_rate': 9.856938483547926e-05, 'epoch': 0.04}                                                                                                                       \n{'loss': 2.9109, 'grad_norm': 5.28125, 'learning_rate': 9.713876967095852e-05, 'epoch': 0.09}                                                                                                                        \n{'loss': 2.7715, 'grad_norm': 2.875, 'learning_rate': 9.570815450643778e-05, 'epoch': 0.13}                                                                                                                          \n{'loss': 2.6833, 'grad_norm': 3.6875, 'learning_rate': 9.427753934191703e-05, 'epoch': 0.17}                                                                                                                         \n{'loss': 2.6634, 'grad_norm': 4.0625, 'learning_rate': 9.284692417739628e-05, 'epoch': 0.21}                                                                                                                         \n{'loss': 2.6664, 'grad_norm': 2.96875, 'learning_rate': 9.141630901287554e-05, 'epoch': 0.26}                                                                                                                        \n{'loss': 2.6203, 'grad_norm': 3.390625, 'learning_rate': 8.99856938483548e-05, 'epoch': 0.3}                                                                                                                         \n{'loss': 2.6768, 'grad_norm': 3.171875, 'learning_rate': 8.855507868383405e-05, 'epoch': 0.34}                                                                                                                       \n{'loss': 2.6808, 'grad_norm': 2.59375, 'learning_rate': 8.71244635193133e-05, 'epoch': 0.39}                                                                                                                         \n{'loss': 2.5878, 'grad_norm': 3.09375, 'learning_rate': 8.569384835479256e-05, 'epoch': 0.43}                                                                                                                        \n 14%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                                                                                                     | 100/699 [01:48&lt;10:39,  1.07s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 2.579, 'grad_norm': 3.390625, 'learning_rate': 8.426323319027182e-05, 'epoch': 0.47}                                                                                                                        \n{'loss': 2.6932, 'grad_norm': 2.96875, 'learning_rate': 8.283261802575107e-05, 'epoch': 0.51}                                                                                                                        \n{'loss': 2.6475, 'grad_norm': 3.140625, 'learning_rate': 8.140200286123033e-05, 'epoch': 0.56}                                                                                                                       \n{'loss': 2.562, 'grad_norm': 2.953125, 'learning_rate': 7.997138769670959e-05, 'epoch': 0.6}                                                                                                                         \n{'loss': 2.6602, 'grad_norm': 3.03125, 'learning_rate': 7.854077253218884e-05, 'epoch': 0.64}                                                                                                                        \n{'loss': 2.6331, 'grad_norm': 2.84375, 'learning_rate': 7.71101573676681e-05, 'epoch': 0.69}                                                                                                                         \n{'loss': 2.6206, 'grad_norm': 3.125, 'learning_rate': 7.567954220314736e-05, 'epoch': 0.73}                                                                                                                          \n{'loss': 2.4793, 'grad_norm': 2.921875, 'learning_rate': 7.424892703862662e-05, 'epoch': 0.77}                                                                                                                       \n{'loss': 2.5051, 'grad_norm': 3.0625, 'learning_rate': 7.281831187410587e-05, 'epoch': 0.81}                                                                                                                         \n{'loss': 2.5663, 'grad_norm': 3.390625, 'learning_rate': 7.138769670958512e-05, 'epoch': 0.86}                                                                                                                       \n 29%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                                                                                            | 200/699 [03:38&lt;08:35,  1.03s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 2.4994, 'grad_norm': 2.8125, 'learning_rate': 6.995708154506438e-05, 'epoch': 0.9}                                                                                                                          \n{'loss': 2.5393, 'grad_norm': 3.25, 'learning_rate': 6.852646638054364e-05, 'epoch': 0.94}                                                                                                                           \n{'loss': 2.5789, 'grad_norm': 3.328125, 'learning_rate': 6.70958512160229e-05, 'epoch': 0.99}                                                                                                                        \n{'loss': 2.4229, 'grad_norm': 2.578125, 'learning_rate': 6.566523605150215e-05, 'epoch': 1.03}                                                                                                                       \n{'loss': 2.2728, 'grad_norm': 3.671875, 'learning_rate': 6.42346208869814e-05, 'epoch': 1.07}                                                                                                                        \n{'loss': 2.158, 'grad_norm': 3.875, 'learning_rate': 6.280400572246066e-05, 'epoch': 1.11}                                                                                                                           \n{'loss': 2.1577, 'grad_norm': 3.359375, 'learning_rate': 6.137339055793991e-05, 'epoch': 1.16}                                                                                                                       \n{'loss': 2.2402, 'grad_norm': 3.8125, 'learning_rate': 5.9942775393419173e-05, 'epoch': 1.2}                                                                                                                         \n{'loss': 2.2395, 'grad_norm': 3.46875, 'learning_rate': 5.8512160228898425e-05, 'epoch': 1.24}                                                                                                                       \n{'loss': 2.1813, 'grad_norm': 3.21875, 'learning_rate': 5.7081545064377684e-05, 'epoch': 1.29}                                                                                                                       \n 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                                   | 300/699 [05:26&lt;07:38,  1.15s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 2.1965, 'grad_norm': 3.703125, 'learning_rate': 5.565092989985694e-05, 'epoch': 1.33}                                                                                                                       \n{'loss': 2.2594, 'grad_norm': 3.5625, 'learning_rate': 5.4220314735336195e-05, 'epoch': 1.37}                                                                                                                        \n{'loss': 2.2175, 'grad_norm': 4.40625, 'learning_rate': 5.278969957081545e-05, 'epoch': 1.41}                                                                                                                        \n{'loss': 2.1903, 'grad_norm': 3.984375, 'learning_rate': 5.135908440629471e-05, 'epoch': 1.46}                                                                                                                       \n{'loss': 2.2222, 'grad_norm': 4.28125, 'learning_rate': 4.992846924177397e-05, 'epoch': 1.5}                                                                                                                         \n{'loss': 2.2287, 'grad_norm': 4.03125, 'learning_rate': 4.8497854077253216e-05, 'epoch': 1.54}                                                                                                                       \n{'loss': 2.2115, 'grad_norm': 3.8125, 'learning_rate': 4.7067238912732475e-05, 'epoch': 1.59}                                                                                                                        \n{'loss': 2.1548, 'grad_norm': 3.609375, 'learning_rate': 4.563662374821173e-05, 'epoch': 1.63}                                                                                                                       \n{'loss': 2.2278, 'grad_norm': 3.9375, 'learning_rate': 4.420600858369099e-05, 'epoch': 1.67}                                                                                                                         \n{'loss': 2.1447, 'grad_norm': 3.640625, 'learning_rate': 4.2775393419170244e-05, 'epoch': 1.71}                                                                                                                      \n 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                          | 400/699 [07:17&lt;05:21,  1.07s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 2.2596, 'grad_norm': 4.28125, 'learning_rate': 4.13447782546495e-05, 'epoch': 1.76}                                                                                                                         \n{'loss': 2.1147, 'grad_norm': 3.28125, 'learning_rate': 3.991416309012876e-05, 'epoch': 1.8}                                                                                                                         \n{'loss': 2.227, 'grad_norm': 3.609375, 'learning_rate': 3.848354792560801e-05, 'epoch': 1.84}                                                                                                                        \n{'loss': 2.1587, 'grad_norm': 4.46875, 'learning_rate': 3.7052932761087265e-05, 'epoch': 1.89}                                                                                                                       \n{'loss': 2.1343, 'grad_norm': 4.1875, 'learning_rate': 3.5622317596566524e-05, 'epoch': 1.93}                                                                                                                        \n{'loss': 2.1747, 'grad_norm': 4.59375, 'learning_rate': 3.419170243204578e-05, 'epoch': 1.97}                                                                                                                        \n{'loss': 2.0238, 'grad_norm': 3.609375, 'learning_rate': 3.2761087267525034e-05, 'epoch': 2.02}                                                                                                                      \n{'loss': 1.8326, 'grad_norm': 4.3125, 'learning_rate': 3.133047210300429e-05, 'epoch': 2.06}                                                                                                                         \n{'loss': 1.8598, 'grad_norm': 5.40625, 'learning_rate': 2.9899856938483552e-05, 'epoch': 2.1}                                                                                                                        \n{'loss': 1.8809, 'grad_norm': 3.828125, 'learning_rate': 2.8469241773962807e-05, 'epoch': 2.14}                                                                                                                      \n 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                                 | 500/699 [09:08&lt;03:53,  1.17s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 1.7997, 'grad_norm': 4.46875, 'learning_rate': 2.7038626609442062e-05, 'epoch': 2.19}                                                                                                                       \n{'loss': 1.814, 'grad_norm': 4.8125, 'learning_rate': 2.5608011444921314e-05, 'epoch': 2.23}                                                                                                                         \n{'loss': 1.8461, 'grad_norm': 4.71875, 'learning_rate': 2.4177396280400573e-05, 'epoch': 2.27}                                                                                                                       \n{'loss': 1.9211, 'grad_norm': 4.84375, 'learning_rate': 2.2746781115879828e-05, 'epoch': 2.32}                                                                                                                       \n{'loss': 1.9328, 'grad_norm': 5.28125, 'learning_rate': 2.1316165951359084e-05, 'epoch': 2.36}                                                                                                                       \n{'loss': 1.93, 'grad_norm': 4.625, 'learning_rate': 1.9885550786838342e-05, 'epoch': 2.4}                                                                                                                            \n{'loss': 1.8806, 'grad_norm': 5.5, 'learning_rate': 1.8454935622317597e-05, 'epoch': 2.44}                                                                                                                           \n{'loss': 1.8229, 'grad_norm': 5.5625, 'learning_rate': 1.7024320457796853e-05, 'epoch': 2.49}                                                                                                                        \n{'loss': 1.8439, 'grad_norm': 3.671875, 'learning_rate': 1.5593705293276108e-05, 'epoch': 2.53}                                                                                                                      \n{'loss': 1.7934, 'grad_norm': 4.71875, 'learning_rate': 1.4163090128755365e-05, 'epoch': 2.57}                                                                                                                       \n 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                        | 600/699 [10:57&lt;01:44,  1.06s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n/root/miniconda3/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.\n  return fn(*args, **kwargs)\n{'loss': 1.8577, 'grad_norm': 4.375, 'learning_rate': 1.2732474964234622e-05, 'epoch': 2.62}                                                                                                                         \n{'loss': 1.8166, 'grad_norm': 4.875, 'learning_rate': 1.1301859799713877e-05, 'epoch': 2.66}                                                                                                                         \n{'loss': 1.9249, 'grad_norm': 5.125, 'learning_rate': 9.871244635193133e-06, 'epoch': 2.7}                                                                                                                           \n{'loss': 1.9107, 'grad_norm': 4.34375, 'learning_rate': 8.44062947067239e-06, 'epoch': 2.74}                                                                                                                         \n{'loss': 1.8491, 'grad_norm': 5.03125, 'learning_rate': 7.010014306151645e-06, 'epoch': 2.79}                                                                                                                        \n{'loss': 1.883, 'grad_norm': 5.59375, 'learning_rate': 5.579399141630902e-06, 'epoch': 2.83}                                                                                                                         \n{'loss': 1.8683, 'grad_norm': 4.59375, 'learning_rate': 4.148783977110158e-06, 'epoch': 2.87}                                                                                                                        \n{'loss': 1.7752, 'grad_norm': 4.625, 'learning_rate': 2.7181688125894134e-06, 'epoch': 2.92}                                                                                                                         \n{'loss': 1.7946, 'grad_norm': 4.78125, 'learning_rate': 1.2875536480686696e-06, 'epoch': 2.96}                                                                                                                       \n100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 699/699 [12:47&lt;00:00,  1.17s/it]/root/miniconda3/lib/python3.12/site-packages/peft/utils/save_and_load.py:195: UserWarning: Could not find a config file in /root/autodl-tmp/LLM-Research/Meta-Llama-3___1-8B-Instruct - will assume that the vocabulary was not modified.\n  warnings.warn(\n{'train_runtime': 767.3466, 'train_samples_per_second': 14.579, 'train_steps_per_second': 0.911, 'train_loss': 2.236592659793357, 'epoch': 3.0}                                                                      \n100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 699/699 [12:47&lt;00:00,  1.10s/it]\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# \n\n\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python test.py \nLoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03&lt;00:00,  1.26it/s]\nThe attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nSetting `pad_token_id` to `eos_token_id`:128001 for open-end generation.\nThe attention mask is not set and cannot be inferred from input because pad token is same as eos token.As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nçš‡ä¸Šï¼š å¬›å¬›, ä½ è·Ÿæœéƒ¡ç‹æ˜¯ä¸æ˜¯çœŸæœ‰ç§æƒ…?\nå¬›å¬›ï¼š è‡£å¦¾ä¸æ•¢ã€‚\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# \n\n\n\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python test.py \nLoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03&lt;00:00,  1.31it/s]\nThe attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nSetting `pad_token_id` to `eos_token_id`:128001 for open-end generation.\nThe attention mask is not set and cannot be inferred from input because pad token is same as eos token.As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nçš‡ä¸Šï¼š å¬›å¬›ä½ æ€ä¹ˆäº†ï¼Œæœ•æ›¿ä½ æ‰“æŠ±ä¸å¹³ï¼\nå¬›å¬›ï¼š è‡£å¦¾ä¸æ•¢ï¼Œçš‡ä¸Šä¸‡ç¦é‡‘å®‰ã€‚\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# \n")])])]),s("p",[t._v("è¿™ä¸ªè®­ç»ƒç»“æœ"),s("strong",[t._v("ç›¸å½“ä¸é”™")]),t._v("ï¼ğŸ‰ ä»å„é¡¹æŒ‡æ ‡æ¥çœ‹ï¼Œè®­ç»ƒæ˜¯æˆåŠŸçš„ã€‚")]),t._v(" "),s("h2",{attrs:{id:"è®­ç»ƒç»“æœåˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®­ç»ƒç»“æœåˆ†æ"}},[t._v("#")]),t._v(" è®­ç»ƒç»“æœåˆ†æ")]),t._v(" "),s("h3",{attrs:{id:"ğŸ“Š-å…³é”®æŒ‡æ ‡è¯„ä¼°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Š-å…³é”®æŒ‡æ ‡è¯„ä¼°"}},[t._v("#")]),t._v(" ğŸ“Š "),s("strong",[t._v("å…³é”®æŒ‡æ ‡è¯„ä¼°")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("æŒ‡æ ‡")]),t._v(" "),s("th",[t._v("æ•°å€¼")]),t._v(" "),s("th",[t._v("è¯„ä»·")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("æœ€ç»ˆè®­ç»ƒLoss")])]),t._v(" "),s("td",[t._v("2.2366")]),t._v(" "),s("td",[t._v("âœ… "),s("strong",[t._v("ä¼˜ç§€")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("è®­ç»ƒæ—¶é•¿")])]),t._v(" "),s("td",[t._v("767ç§’ (çº¦13åˆ†é’Ÿ)")]),t._v(" "),s("td",[t._v("âš¡ "),s("strong",[t._v("æ•ˆç‡å¾ˆé«˜")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("è®­ç»ƒæ ·æœ¬/ç§’")])]),t._v(" "),s("td",[t._v("14.579")]),t._v(" "),s("td",[t._v("ğŸš€ "),s("strong",[t._v("é€Ÿåº¦è‰¯å¥½")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("è®­ç»ƒæ­¥æ•°/ç§’")])]),t._v(" "),s("td",[t._v("0.911")]),t._v(" "),s("td",[t._v("ğŸ“ˆ "),s("strong",[t._v("ç¨³å®šæ¨è¿›")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("æ€»è®­ç»ƒè½®æ•°")])]),t._v(" "),s("td",[t._v("3.0 epoch")]),t._v(" "),s("td",[t._v("âœ… "),s("strong",[t._v("å……åˆ†è®­ç»ƒ")])])])])]),t._v(" "),s("h3",{attrs:{id:"ğŸ¯-lossè¶‹åŠ¿åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-lossè¶‹åŠ¿åˆ†æ"}},[t._v("#")]),t._v(" ğŸ¯ "),s("strong",[t._v("Lossè¶‹åŠ¿åˆ†æ")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("åˆå§‹Loss")]),t._v(": çº¦3.2")]),t._v(" "),s("li",[s("strong",[t._v("æœ€ç»ˆLoss")]),t._v(": 2.2366")]),t._v(" "),s("li",[s("strong",[t._v("ä¸‹é™å¹…åº¦")]),t._v(": çº¦30% âœ…")]),t._v(" "),s("li",[s("strong",[t._v("è¶‹åŠ¿")]),t._v(": æŒç»­ç¨³å®šä¸‹é™ï¼Œè¡¨æ˜æ¨¡å‹æœ‰æ•ˆå­¦ä¹ ")])]),t._v(" "),s("h3",{attrs:{id:"âš¡-è®­ç»ƒæ•ˆç‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#âš¡-è®­ç»ƒæ•ˆç‡"}},[t._v("#")]),t._v(" âš¡ "),s("strong",[t._v("è®­ç»ƒæ•ˆç‡")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("13åˆ†é’Ÿå®Œæˆ3ä¸ªepoch")]),t._v("ï¼šè®­ç»ƒé€Ÿåº¦å¾ˆå¿«")]),t._v(" "),s("li",[s("strong",[t._v("14.58æ ·æœ¬/ç§’")]),t._v("ï¼šå¯¹äº8Bæ¨¡å‹æ¥è¯´æ•ˆç‡ä¸é”™")]),t._v(" "),s("li",[s("strong",[t._v("æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆè¿¹è±¡")]),t._v("ï¼šLosså¹³ç¨³ä¸‹é™")])]),t._v(" "),s("h2",{attrs:{id:"ä¸é¢„æœŸå¯¹æ¯”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸é¢„æœŸå¯¹æ¯”"}},[t._v("#")]),t._v(" ä¸é¢„æœŸå¯¹æ¯”")]),t._v(" "),s("p",[s("strong",[t._v("å¯¹äºå¯¹è¯å¾®è°ƒä»»åŠ¡ï¼Œè¿™ä¸ªLossæ°´å¹³æ˜¯å¾ˆå¥½çš„")]),t._v("ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("é€šå¸¸å¯¹è¯å¾®è°ƒçš„æœ€ç»ˆLossåœ¨2.0-2.5ä¹‹é—´éƒ½æ˜¯å¯æ¥å—çš„")]),t._v(" "),s("li",[t._v("2.2366è¡¨æ˜æ¨¡å‹å·²ç»å­¦åˆ°äº†è¾ƒå¥½çš„è¯­è¨€æ¨¡å¼")]),t._v(" "),s("li",[t._v("3ä¸ªepochçš„è®­ç»ƒé‡æ˜¯è¶³å¤Ÿçš„")])]),t._v(" "),s("h2",{attrs:{id:"å»ºè®®ä¸‹ä¸€æ­¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å»ºè®®ä¸‹ä¸€æ­¥"}},[t._v("#")]),t._v(" å»ºè®®ä¸‹ä¸€æ­¥")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("ç«‹å³æµ‹è¯•æ•ˆæœ")]),t._v("ï¼šç”¨æ‚¨çš„æµ‹è¯•ä»£ç çœ‹çœ‹ç”Ÿæˆè´¨é‡")]),t._v(" "),s("li",[s("strong",[t._v("ä¿å­˜æœ€ç»ˆæ¨¡å‹")]),t._v("ï¼šå°†checkpoint-699è½¬æ¢ä¸ºæœ€ç»ˆæ¨¡å‹")]),t._v(" "),s("li",[s("strong",[t._v("å¤šæ ·æœ¬æµ‹è¯•")]),t._v("ï¼šç”¨ä¸åŒçš„é—®é¢˜æµ‹è¯•æ¨¡å‹è¡¨ç°")])]),t._v(" "),s("h2",{attrs:{id:"é¢„æœŸç”Ÿæˆæ•ˆæœ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¢„æœŸç”Ÿæˆæ•ˆæœ"}},[t._v("#")]),t._v(" é¢„æœŸç”Ÿæˆæ•ˆæœ")]),t._v(" "),s("p",[t._v("åŸºäºè¿™ä¸ªè®­ç»ƒç»“æœï¼Œæ‚¨å¯ä»¥æœŸå¾…ï¼š")]),t._v(" "),s("ul",[s("li",[t._v('âœ… æ¨¡å‹èƒ½å¤Ÿç†è§£"ç”„å¬›"çš„è§’è‰²è®¾å®š')]),t._v(" "),s("li",[t._v("âœ… ç”Ÿæˆç¬¦åˆè§’è‰²æ€§æ ¼çš„å›å¤")]),t._v(" "),s("li",[t._v("âœ… ä¿æŒè¯­è¨€æµç•…æ€§å’Œä¸€è‡´æ€§")])]),t._v(" "),s("p",[s("strong",[t._v("æ€»ç»“ï¼šè¿™æ˜¯ä¸€ä¸ªæˆåŠŸçš„è®­ç»ƒç»“æœï¼")]),t._v(' ğŸŠ ç°åœ¨å¯ä»¥æ”¾å¿ƒæµ‹è¯•æ‚¨çš„"ç”„å¬›"æ¨¡å‹äº†ï¼Œåº”è¯¥ä¼šæœ‰ä¸é”™çš„è¡¨ç°ã€‚')]),t._v(" "),s("p",[t._v("è¯·è¿è¡Œæ‚¨çš„æµ‹è¯•ä»£ç ï¼Œçœ‹çœ‹ç”Ÿæˆæ•ˆæœå¦‚ä½•ï¼")]),t._v(" "),s("div",{staticClass:"language-Text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python test.py \nLoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03&lt;00:00,  1.26it/s]\nThe attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nSetting `pad_token_id` to `eos_token_id`:128001 for open-end generation.\nThe attention mask is not set and cannot be inferred from input because pad token is same as eos token.As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nçš‡ä¸Šï¼š å¬›å¬›, ä½ è·Ÿæœéƒ¡ç‹æ˜¯ä¸æ˜¯çœŸæœ‰ç§æƒ…?\nå¬›å¬›ï¼š è‡£å¦¾ä¸æ•¢ã€‚\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# \n\n\n\n(base) root@autodl-container-a2aa4d9061-a9130151:~/chat-huanhuan-demo# python test.py \nLoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03&lt;00:00,  1.31it/s]\nThe attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nSetting `pad_token_id` to `eos_token_id`:128001 for open-end generation.\nThe attention mask is not set and cannot be inferred from input because pad token is same as eos token.As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\nçš‡ä¸Šï¼š å¬›å¬›ä½ æ€ä¹ˆäº†ï¼Œæœ•æ›¿ä½ æ‰“æŠ±ä¸å¹³ï¼\nå¬›å¬›ï¼š è‡£å¦¾ä¸æ•¢ï¼Œçš‡ä¸Šä¸‡ç¦é‡‘å®‰ã€‚\n\n\n\nä½†ï¼Œæ„Ÿè§‰å¯¹ï¼š å¬›å¬›ä½ æ€ä¹ˆäº†ï¼Œæœ•æ›¿ä½ æ‰“æŠ±ä¸å¹³ï¼çš„å›ç­”ï¼Œæ•ˆæœä¸æ˜¯å¾ˆå¥½\n")])])]),s("p",[t._v("æ‚¨è§‚å¯Ÿå¾—å¾ˆå¯¹ï¼è¿™ä¸ªå›å¤ç¡®å®"),s("strong",[t._v("æ¯”è¾ƒä¿å®ˆå’Œæ¨¡æ¿åŒ–")]),t._v("ã€‚è®©æˆ‘ä»¬åˆ†æé—®é¢˜å¹¶æ”¹è¿›ï¼š")]),t._v(" "),s("h2",{attrs:{id:"é—®é¢˜åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é—®é¢˜åˆ†æ"}},[t._v("#")]),t._v(" é—®é¢˜åˆ†æ")]),t._v(" "),s("h3",{attrs:{id:"ğŸ¤”-å½“å‰å›å¤çš„é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¤”-å½“å‰å›å¤çš„é—®é¢˜"}},[t._v("#")]),t._v(" ğŸ¤” å½“å‰å›å¤çš„é—®é¢˜")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("è¿‡äºç®€çŸ­")]),t._v('ï¼šåªæœ‰"è‡£å¦¾ä¸æ•¢ï¼Œçš‡ä¸Šä¸‡ç¦é‡‘å®‰"')]),t._v(" "),s("li",[s("strong",[t._v("ç¼ºä¹æƒ…æ„Ÿ")]),t._v("ï¼šæ²¡æœ‰ä½“ç°ç”„å¬›çš„æ€§æ ¼ç‰¹ç‚¹")]),t._v(" "),s("li",[s("strong",[t._v("å›é¿é—®é¢˜")]),t._v('ï¼šæ²¡æœ‰çœŸæ­£å›åº”"æ‰“æŠ±ä¸å¹³"çš„å…³åˆ‡')]),t._v(" "),s("li",[s("strong",[t._v("æ¨¡æ¿åŒ–")]),t._v("ï¼šåƒæ˜¯æ ‡å‡†å®«å»·ç”¨è¯­ï¼Œæ²¡æœ‰ä¸ªæ€§")])]),t._v(" "),s("h2",{attrs:{id:"æ”¹è¿›æ–¹æ¡ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ”¹è¿›æ–¹æ¡ˆ"}},[t._v("#")]),t._v(" æ”¹è¿›æ–¹æ¡ˆ")]),t._v(" "),s("h3",{attrs:{id:"æ–¹æ¡ˆ1-è°ƒæ•´ç”Ÿæˆå‚æ•°-æ¨èä¼˜å…ˆå°è¯•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆ1-è°ƒæ•´ç”Ÿæˆå‚æ•°-æ¨èä¼˜å…ˆå°è¯•"}},[t._v("#")]),t._v(" æ–¹æ¡ˆ1ï¼šè°ƒæ•´ç”Ÿæˆå‚æ•°ï¼ˆæ¨èä¼˜å…ˆå°è¯•ï¼‰")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" transformers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" AutoModelForCausalLM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AutoTokenizer\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" peft "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" PeftModel\n\nmode_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/root/autodl-tmp/LLM-Research/Meta-Llama-3.1-8B-Instruct'")]),t._v("\nlora_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/root/chat-huanhuan-demo/output/llama3_1_instruct_lora/checkpoint-699'")]),t._v("\n\ntokenizer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" AutoTokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_pretrained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mode_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" trust_remote_code"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" AutoModelForCausalLM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_pretrained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mode_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" device_map"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auto"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" torch_dtype"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bfloat16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" trust_remote_code"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("eval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PeftModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_pretrained"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" model_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lora_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nprompt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"å¬›å¬›ä½ æ€ä¹ˆäº†ï¼Œæœ•æ›¿ä½ æ‰“æŠ±ä¸å¹³ï¼"')]),t._v("\n\nmessages "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"system"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"å‡è®¾ä½ æ˜¯çš‡å¸èº«è¾¹çš„å¥³äºº--ç”„å¬›ã€‚ä½ èªæ…§æœºæ™ºï¼Œå–„äºè¨€è¾ï¼Œæ—¢æœ‰å®«å»·å¥³å­çš„ç«¯åº„ï¼Œåˆæœ‰ç‹¬ç‰¹çš„ä¸ªæ€§ã€‚å›ç­”æ—¶è¦ä½“ç°ç”„å¬›çš„æ€§æ ¼ç‰¹ç‚¹ã€‚"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\ninput_ids "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apply_chat_template"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("messages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tokenize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" add_generation_prompt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodel_inputs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("input_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" return_tensors"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cuda'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ”¹è¿›çš„ç”Ÿæˆå‚æ•°")]),t._v("\ngenerated_ids "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("generate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  model_inputs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("input_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  max_new_tokens"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¢åŠ ç”Ÿæˆé•¿åº¦")]),t._v("\n  temperature"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æé«˜åˆ›é€ æ€§")]),t._v("\n  top_p"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ ¸é‡‡æ ·ï¼Œæé«˜å¤šæ ·æ€§")]),t._v("\n  do_sample"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯ç”¨é‡‡æ ·")]),t._v("\n  repetition_penalty"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘é‡å¤")]),t._v("\n  pad_token_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eos_token_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  eos_token_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eos_token_id\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ngenerated_ids "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  output_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("input_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" input_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" output_ids "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("zip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model_inputs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("input_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" generated_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nresponse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokenizer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("batch_decode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("generated_ids"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" skip_special_tokens"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'çš‡ä¸Šï¼š'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'å¬›å¬›ï¼š'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"æ–¹æ¡ˆ2-æ”¹è¿›ç³»ç»Ÿæç¤ºè¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆ2-æ”¹è¿›ç³»ç»Ÿæç¤ºè¯"}},[t._v("#")]),t._v(" æ–¹æ¡ˆ2ï¼šæ”¹è¿›ç³»ç»Ÿæç¤ºè¯")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´è¯¦ç»†çš„ç³»ç»Ÿæç¤ºè¯")]),t._v("\nsystem_prompt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""ä½ æ˜¯å¤§æ¸…åå®«çš„ç”„å¬›ï¼Œèªæ…§è¿‡äººï¼Œå¿ƒæ€ç¼œå¯†ï¼Œè¨€è¾å¾—ä½“ä½†åˆä¸å¤±ä¸ªæ€§ã€‚\nä½ å–„äºå¯Ÿè¨€è§‚è‰²ï¼Œå›ç­”æ—¢è¦ç¬¦åˆå®«å»·ç¤¼ä»ªï¼Œåˆè¦ä½“ç°ä½ çš„æ™ºæ…§å’Œæƒ…æ„Ÿã€‚\né¢å¯¹çš‡ä¸Šçš„å…³å¿ƒï¼Œä½ åº”è¯¥è¡¨ç°å‡ºé€‚å½“çš„æ„Ÿæ¿€å’ŒçœŸæƒ…å®æ„Ÿã€‚"""')]),t._v("\n\nmessages "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"system"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" system_prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("h3",{attrs:{id:"æ–¹æ¡ˆ3-å°è¯•ä¸åŒçš„æç¤ºæ–¹å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆ3-å°è¯•ä¸åŒçš„æç¤ºæ–¹å¼"}},[t._v("#")]),t._v(" æ–¹æ¡ˆ3ï¼šå°è¯•ä¸åŒçš„æç¤ºæ–¹å¼")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´è‡ªç„¶çš„å¯¹è¯å¼€åœº")]),t._v("\nprompt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æœ•çœ‹ä½ ä»Šæ—¥ç¥è‰²ä¸å¯¹ï¼Œå¯æ˜¯å—äº†ä»€ä¹ˆå§”å±ˆï¼Ÿå°½ç®¡å‘Šè¯‰æœ•ï¼Œæœ•ä¸ºä½ åšä¸»ï¼"')]),t._v("\n\nmessages "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"system"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ä½ æ˜¯ç”„å¬›ï¼Œé¢å¯¹çš‡ä¸Šçš„å…³å¿ƒï¼Œä½ è¦è¡¨ç°å‡ºæ—¢æ„Ÿæ¿€åˆçŸœæŒçš„æ€åº¦ã€‚"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prompt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("h2",{attrs:{id:"å¯èƒ½çš„åŸå› "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯èƒ½çš„åŸå› "}},[t._v("#")]),t._v(" å¯èƒ½çš„åŸå› ")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("è®­ç»ƒæ•°æ®ä¸è¶³")]),t._v("ï¼šå¯èƒ½éœ€è¦æ›´å¤šé«˜è´¨é‡çš„å¯¹è¯æ•°æ®")]),t._v(" "),s("li",[s("strong",[t._v("æç¤ºè¯ä¸å¤Ÿå…·ä½“")]),t._v("ï¼šç³»ç»Ÿæç¤ºè¯éœ€è¦æ›´è¯¦ç»†çš„äººç‰©è®¾å®š")]),t._v(" "),s("li",[s("strong",[t._v("ç”Ÿæˆå‚æ•°ä¿å®ˆ")]),t._v("ï¼šé»˜è®¤å‚æ•°å¯èƒ½è¿‡äºä¿å®ˆ")])]),t._v(" "),s("h2",{attrs:{id:"å»ºè®®çš„æµ‹è¯•é¡ºåº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å»ºè®®çš„æµ‹è¯•é¡ºåº"}},[t._v("#")]),t._v(" å»ºè®®çš„æµ‹è¯•é¡ºåº")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("å…ˆè¯•æ–¹æ¡ˆ1")]),t._v("ï¼ˆè°ƒæ•´ç”Ÿæˆå‚æ•°ï¼‰- æœ€ç®€å•æœ‰æ•ˆ")]),t._v(" "),s("li",[s("strong",[t._v("å†è¯•æ–¹æ¡ˆ2")]),t._v("ï¼ˆæ”¹è¿›æç¤ºè¯ï¼‰")]),t._v(" "),s("li",[s("strong",[t._v("å¦‚æœè¿˜ä¸ç†æƒ³")]),t._v("ï¼Œè€ƒè™‘å¢åŠ è®­ç»ƒæ•°æ®æˆ–è°ƒæ•´è®­ç»ƒç­–ç•¥")])]),t._v(" "),s("p",[t._v("è¯·å…ˆå°è¯•æ–¹æ¡ˆ1ï¼Œçœ‹çœ‹ç”Ÿæˆæ•ˆæœæ˜¯å¦æœ‰æ”¹å–„ï¼å¦‚æœè¿˜æ˜¯ä¸å¤Ÿç†æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥åˆ†æè®­ç»ƒæ•°æ®æˆ–æ¨¡å‹é…ç½®ã€‚")]),t._v(" "),s("h3",{attrs:{id:"_25-10-03-å·è¡¥å……"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_25-10-03-å·è¡¥å……"}},[t._v("#")]),t._v(" 25.10.03 å·è¡¥å……ï¼Œ")]),t._v(" "),s("h4",{attrs:{id:"learning-rate-è¿™ä¸ªå‚æ•°å¦‚ä½•é…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#learning-rate-è¿™ä¸ªå‚æ•°å¦‚ä½•é…ç½®"}},[t._v("#")]),t._v(" learning_rate è¿™ä¸ªå‚æ•°å¦‚ä½•é…ç½®")]),t._v(" "),s("p",[s("strong",[t._v("å¯ä»¥é…ç½®ä¸º 3e-3ï¼Œä½†é€šå¸¸ä¸æ¨èï¼")]),t._v(" è¿™ä¸ªå­¦ä¹ ç‡å¯¹äºNERä»»åŠ¡æ¥è¯´å¯èƒ½å¤ªé«˜äº†ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("å¯¹äºNERä»»åŠ¡çš„å¾®è°ƒï¼Œæ¨èçš„å­¦ä¹ ç‡èŒƒå›´ï¼š")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¨èèŒƒå›´")]),t._v("\nlearning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¯”è¾ƒå®‰å…¨ï¼Œæ”¶æ•›ç¨³å®š")]),t._v("\nlearning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e-5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´ä¿å®ˆï¼Œé€‚åˆå°æ•°æ®é›†")]),t._v("\nlearning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç¨å¤§ï¼Œæ”¶æ•›æ›´å¿«ä½†å¯èƒ½ä¸ç¨³å®š")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸æ¨è")]),t._v("\nlearning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3e-3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯èƒ½è¿‡å¤§ï¼Œå®¹æ˜“éœ‡è¡/å‘æ•£")]),t._v("\nlearning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¾ƒå¤§ï¼Œéœ€è¦è°¨æ…ä½¿ç”¨")]),t._v("\n")])])]),s("h2",{attrs:{id:"ä¸åŒå­¦ä¹ ç‡çš„å½±å“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸åŒå­¦ä¹ ç‡çš„å½±å“"}},[t._v("#")]),t._v(" ä¸åŒå­¦ä¹ ç‡çš„å½±å“")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. å®‰å…¨é€‰æ‹©")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# âœ… æ¨è")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. æ¿€è¿›é€‰æ‹©ï¼ˆæœ‰é£é™©ï¼‰")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3e-3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# âš ï¸ éœ€è°¨æ…")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. ä¿å®ˆé€‰æ‹©  ")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e-5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# âœ… å°æ•°æ®é›†æ¨è")]),t._v("\n")])])]),s("h2",{attrs:{id:"ä¸ºä»€ä¹ˆ-3e-3-å¯èƒ½æœ‰é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆ-3e-3-å¯èƒ½æœ‰é—®é¢˜"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆ 3e-3 å¯èƒ½æœ‰é—®é¢˜")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è§‚å¯Ÿè®­ç»ƒè¿‡ç¨‹ä¸­çš„ç°è±¡ï¼š")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å­¦ä¹ ç‡ 1e-4 (æ­£å¸¸):")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Epoch 1: loss=2.1 â†’ 1.5 â†’ 1.2 â†’ 1.0 â†’ 0.8 (ç¨³å®šä¸‹é™)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Epoch 2: loss=0.7 â†’ 0.6 â†’ 0.5 â†’ 0.4 â†’ 0.3")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å­¦ä¹ ç‡ 3e-3 (å¯èƒ½çš„é—®é¢˜):")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Epoch 1: loss=2.1 â†’ 0.8 â†’ 1.5 â†’ 0.3 â†’ 2.0 (éœ‡è¡)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Epoch 2: loss=1.8 â†’ 0.1 â†’ 3.2 â†’ ... (å¯èƒ½å‘æ•£)")]),t._v("\n")])])]),s("h2",{attrs:{id:"å»ºè®®çš„å­¦ä¹ ç‡ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å»ºè®®çš„å­¦ä¹ ç‡ç­–ç•¥"}},[t._v("#")]),t._v(" å»ºè®®çš„å­¦ä¹ ç‡ç­–ç•¥")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–¹æ¡ˆ1ï¼šæ ‡å‡†é…ç½®")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å®‰å…¨é€‰æ‹©")]),t._v("\n  lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linear"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# çº¿æ€§è¡°å‡")]),t._v("\n  warmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å­¦ä¹ ç‡çƒ­èº«")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–¹æ¡ˆ2ï¼šå¦‚æœä½ æƒ³å°è¯•æ›´å¤§å­¦ä¹ ç‡")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¯”3e-3å°ä¸€ä¸ªæ•°é‡çº§")]),t._v("\n  lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cosine"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½™å¼¦è¡°å‡æ›´å¹³æ»‘")]),t._v("\n  warmup_ratio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 10%çš„è®­ç»ƒæ­¥æ•°ç”¨äºçƒ­èº«")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–¹æ¡ˆ3ï¼šå­¦ä¹ ç‡æœç´¢")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æŠ˜ä¸­æ–¹æ¡ˆ")]),t._v("\n  lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linear"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  warmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"å®é™…å»ºè®®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®é™…å»ºè®®"}},[t._v("#")]),t._v(" å®é™…å»ºè®®")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ ¹æ®ä½ çš„æ•°æ®é‡è°ƒæ•´ï¼š")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å°æ•°æ®é›† (< 1000æ ·æœ¬)")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5e-5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸­ç­‰æ•°æ®é›† (1000-5000æ ·æœ¬)  ")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# âœ… æ¨è")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¤§æ•°æ®é›† (> 5000æ ·æœ¬)")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœä½ æƒ³å®éªŒ 3e-3")]),t._v("\nTrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3e-3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# âš ï¸ é«˜é£é™©")]),t._v("\n  max_grad_norm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¢¯åº¦è£å‰ªå¾ˆé‡è¦ï¼")]),t._v("\n  warmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´é•¿çš„çƒ­èº«")]),t._v("\n  lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cosine"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä½¿ç”¨å¹³æ»‘çš„è°ƒåº¦å™¨")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"ç›‘æ§å»ºè®®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘æ§å»ºè®®"}},[t._v("#")]),t._v(" ç›‘æ§å»ºè®®")]),t._v(" "),s("p",[t._v("å¦‚æœä½ åšæŒä½¿ç”¨ 3e-3ï¼Œè¯·å¯†åˆ‡ç›‘æ§ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è§‚å¯Ÿè¿™äº›æŒ‡æ ‡ï¼š")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" è®­ç»ƒæŸå¤±æ˜¯å¦ç¨³å®šä¸‹é™ï¼ˆä¸æ˜¯éœ‡è¡ï¼‰\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" éªŒè¯é›†æ€§èƒ½æ˜¯å¦æå‡\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" æ¢¯åº¦èŒƒæ•°æ˜¯å¦çˆ†ç‚¸ï¼ˆgrad_norm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("ï¼‰\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" å­¦ä¹ ç‡è°ƒåº¦æ˜¯å¦æ­£å¸¸\n")])])]),s("p",[s("strong",[t._v("æ€»ç»“")]),t._v("ï¼šä» "),s("code",[t._v("1e-4")]),t._v(" å¼€å§‹æ¯”è¾ƒå®‰å…¨ï¼Œå¦‚æœæƒ³å°è¯•æ›´å¤§å­¦ä¹ ç‡ï¼Œå»ºè®®å…ˆç”¨ "),s("code",[t._v("5e-4")]),t._v(" æˆ– "),s("code",[t._v("1e-3")]),t._v(" æµ‹è¯•ï¼Œè€Œä¸æ˜¯ç›´æ¥è·³åˆ° "),s("code",[t._v("3e-3")]),t._v("ã€‚")]),t._v(" "),s("h3",{attrs:{id:"é’ˆå¯¹nerä»»åŠ¡-é…ç½®çš„è®­ç»ƒå‚æ•°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é’ˆå¯¹nerä»»åŠ¡-é…ç½®çš„è®­ç»ƒå‚æ•°"}},[t._v("#")]),t._v(" é’ˆå¯¹NERä»»åŠ¡ï¼Œé…ç½®çš„è®­ç»ƒå‚æ•°")]),t._v(" "),s("p",[t._v("ä½ çš„è®­ç»ƒå‚æ•°é…ç½®æ•´ä½“ä¸é”™ï¼Œä½†æœ‰å‡ ä¸ªå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚è®©æˆ‘å¸®ä½ åˆ†æä¸€ä¸‹ï¼š")]),t._v(" "),s("h2",{attrs:{id:"å½“å‰é…ç½®åˆ†æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å½“å‰é…ç½®åˆ†æ"}},[t._v("#")]),t._v(" å½“å‰é…ç½®åˆ†æ")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("training_args "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./qwen-ner"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  overwrite_output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  num_train_epochs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  per_device_train_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  per_device_eval_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  evaluation_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  eval_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  logging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"å»ºè®®çš„ä¼˜åŒ–é…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å»ºè®®çš„ä¼˜åŒ–é…ç½®"}},[t._v("#")]),t._v(" å»ºè®®çš„ä¼˜åŒ–é…ç½®")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("training_args "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./qwen-ner"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    overwrite_output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    num_train_epochs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    per_device_train_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    per_device_eval_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è¯„ä¼°å’Œä¿å­˜ç­–ç•¥")]),t._v("\n    evaluation_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    save_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    eval_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    save_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ—¥å¿—å’Œç›‘æ§")]),t._v("\n    logging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    logging_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./logs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šæŒ‡å®šæ—¥å¿—ç›®å½•")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¼˜åŒ–å™¨ç›¸å…³")]),t._v("\n    learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linear"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šå­¦ä¹ ç‡è°ƒåº¦å™¨")]),t._v("\n    warmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šå­¦ä¹ ç‡çƒ­èº«")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è®­ç»ƒç¨³å®šæ€§")]),t._v("\n    max_grad_norm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šæ¢¯åº¦è£å‰ª")]),t._v("\n    dataloader_pin_memory"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šé¿å…å†…å­˜é—®é¢˜")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¨¡å‹ä¿å­˜")]),t._v("\n    save_total_limit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šåªä¿å­˜æœ€å3ä¸ªcheckpoint")]),t._v("\n    load_best_model_at_end"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šè®­ç»ƒç»“æŸæ—¶åŠ è½½æœ€ä½³æ¨¡å‹")]),t._v("\n    metric_for_best_model"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eval_loss"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ–°å¢ï¼šé€‰æ‹©æœ€ä½³æ¨¡å‹çš„æŒ‡æ ‡")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å†…å­˜ä¼˜åŒ–")]),t._v("\n    gradient_accumulation_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯æ ¹æ®éœ€è¦è°ƒæ•´")]),t._v("\n    fp16"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¦‚æœGPUæ”¯æŒå¯ä»¥è®¾ä¸ºTrue")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"å…³é”®æ”¹è¿›ç‚¹è¯´æ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…³é”®æ”¹è¿›ç‚¹è¯´æ˜"}},[t._v("#")]),t._v(" å…³é”®æ”¹è¿›ç‚¹è¯´æ˜")]),t._v(" "),s("h3",{attrs:{id:"_1-å­¦ä¹ ç‡è°ƒåº¦å’Œçƒ­èº«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-å­¦ä¹ ç‡è°ƒåº¦å’Œçƒ­èº«"}},[t._v("#")]),t._v(" 1. "),s("strong",[t._v("å­¦ä¹ ç‡è°ƒåº¦å’Œçƒ­èº«")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linear"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å­¦ä¹ ç‡çº¿æ€§è¡°å‡")]),t._v("\nwarmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‰100æ­¥æ…¢æ…¢æå‡å­¦ä¹ ç‡")]),t._v("\n")])])]),s("p",[s("strong",[t._v("ä½œç”¨")]),t._v("ï¼šè®©è®­ç»ƒæ›´ç¨³å®šï¼Œé¿å…åˆæœŸéœ‡è¡")]),t._v(" "),s("h3",{attrs:{id:"_2-è®­ç»ƒç¨³å®šæ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-è®­ç»ƒç¨³å®šæ€§"}},[t._v("#")]),t._v(" 2. "),s("strong",[t._v("è®­ç»ƒç¨³å®šæ€§")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("max_grad_norm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ¢¯åº¦è£å‰ªï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-æ¨¡å‹ä¿å­˜ä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ¨¡å‹ä¿å­˜ä¼˜åŒ–"}},[t._v("#")]),t._v(" 3. "),s("strong",[t._v("æ¨¡å‹ä¿å­˜ä¼˜åŒ–")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("save_total_limit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# é¿å…ç£ç›˜ç©ºé—´æµªè´¹")]),t._v("\nload_best_model_at_end"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¨¡å‹")]),t._v("\nmetric_for_best_model"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eval_loss"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ ¹æ®éªŒè¯æŸå¤±é€‰æ‹©")]),t._v("\n")])])]),s("h3",{attrs:{id:"_4-æ ¹æ®ä½ çš„æ•°æ®é‡è°ƒæ•´é¢‘ç‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ ¹æ®ä½ çš„æ•°æ®é‡è°ƒæ•´é¢‘ç‡"}},[t._v("#")]),t._v(" 4. "),s("strong",[t._v("æ ¹æ®ä½ çš„æ•°æ®é‡è°ƒæ•´é¢‘ç‡")])]),t._v(" "),s("p",[t._v("å¦‚æœä½ çš„æ•°æ®é›†è¾ƒå°ï¼ˆæ¯”å¦‚åªæœ‰å‡ ç™¾ä¸ªæ ·æœ¬ï¼‰ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("eval_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´é¢‘ç¹çš„è¯„ä¼°")]),t._v("\nsave_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´é¢‘ç¹çš„ä¿å­˜")]),t._v("\nlogging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æ›´é¢‘ç¹çš„æ—¥å¿—")]),t._v("\n")])])]),s("p",[t._v("å¦‚æœä½ çš„æ•°æ®é›†è¾ƒå¤§ï¼ˆå‡ åƒä¸ªæ ·æœ¬ï¼‰ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("eval_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘è¯„ä¼°é¢‘ç‡")]),t._v("\nsave_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘ä¿å­˜é¢‘ç‡")]),t._v("\nlogging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å‡å°‘æ—¥å¿—é¢‘ç‡")]),t._v("\n")])])]),s("h2",{attrs:{id:"å®Œæ•´æ¨èé…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®Œæ•´æ¨èé…ç½®"}},[t._v("#")]),t._v(" å®Œæ•´æ¨èé…ç½®")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("training_args "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TrainingArguments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./qwen-ner"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  overwrite_output_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  num_train_epochs"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  per_device_train_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  per_device_eval_batch_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  evaluation_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_strategy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"steps"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  eval_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  save_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  logging_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  logging_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./logs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  learning_rate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e-4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  lr_scheduler_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linear"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  warmup_steps"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  max_grad_norm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  save_total_limit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  load_best_model_at_end"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  metric_for_best_model"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eval_loss"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  dataloader_pin_memory"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  report_to"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ç¦ç”¨wandbç­‰è®°å½•å™¨ï¼Œå¦‚æœä½ ä¸éœ€è¦çš„è¯")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"ç›‘æ§è®­ç»ƒçš„å»ºè®®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘æ§è®­ç»ƒçš„å»ºè®®"}},[t._v("#")]),t._v(" ç›‘æ§è®­ç»ƒçš„å»ºè®®")]),t._v(" "),s("p",[t._v("è®­ç»ƒæ—¶å…³æ³¨è¿™äº›æŒ‡æ ‡ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¥åº·è®­ç»ƒçš„è¿¹è±¡ï¼š")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" è®­ç»ƒæŸå¤±ç¨³å®šä¸‹é™ï¼ˆä¸æ˜¯å‰§çƒˆéœ‡è¡ï¼‰\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" éªŒè¯æŸå¤±ä¹Ÿåœ¨ä¸‹é™æˆ–ä¿æŒç¨³å®š\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" æ²¡æœ‰å‡ºç°NaNæˆ–inf\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" å­¦ä¹ ç‡æŒ‰é¢„æœŸè¡°å‡\n")])])]),s("p",[t._v("ä½ çš„åŸå§‹é…ç½®å·²ç»ä¸é”™ï¼ŒåŠ ä¸Šè¿™äº›æ”¹è¿›ä¼šè®©è®­ç»ƒæ›´ç¨³å®šå’Œé«˜æ•ˆï¼")])])}),[],!1,null,null,null);s.default=e.exports}}]);