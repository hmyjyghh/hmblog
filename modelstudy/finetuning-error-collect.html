<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OM é”™è¯¯ | å¯’æ¢¦çš„åšå®¢</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/hmblog/logo.png">
    <meta name="description" content="å®å‰‘é”‹ä»ç£¨ç ºå‡ºï¼Œæ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥ã€‚">
    
    <link rel="preload" href="/hmblog/assets/css/0.styles.e7d53aa5.css" as="style"><link rel="preload" href="/hmblog/assets/js/app.252ae38c.js" as="script"><link rel="preload" href="/hmblog/assets/js/7.5041dce4.js" as="script"><link rel="preload" href="/hmblog/assets/js/2.79670d2b.js" as="script"><link rel="preload" href="/hmblog/assets/js/1.1d6abb18.js" as="script"><link rel="preload" href="/hmblog/assets/js/76.f614fd28.js" as="script"><link rel="preload" href="/hmblog/assets/js/34.b26cede8.js" as="script"><link rel="prefetch" href="/hmblog/assets/js/10.63d0ad8f.js"><link rel="prefetch" href="/hmblog/assets/js/100.5613e6ba.js"><link rel="prefetch" href="/hmblog/assets/js/101.b8eb0459.js"><link rel="prefetch" href="/hmblog/assets/js/102.40868c51.js"><link rel="prefetch" href="/hmblog/assets/js/103.1f40d097.js"><link rel="prefetch" href="/hmblog/assets/js/104.4e73c56a.js"><link rel="prefetch" href="/hmblog/assets/js/105.cb525ef5.js"><link rel="prefetch" href="/hmblog/assets/js/106.252f49ca.js"><link rel="prefetch" href="/hmblog/assets/js/107.91d170e8.js"><link rel="prefetch" href="/hmblog/assets/js/108.8a514186.js"><link rel="prefetch" href="/hmblog/assets/js/109.f15844d7.js"><link rel="prefetch" href="/hmblog/assets/js/11.08937b90.js"><link rel="prefetch" href="/hmblog/assets/js/110.a0e27b36.js"><link rel="prefetch" href="/hmblog/assets/js/111.1c542559.js"><link rel="prefetch" href="/hmblog/assets/js/112.5fa57e84.js"><link rel="prefetch" href="/hmblog/assets/js/113.bfbfcd5a.js"><link rel="prefetch" href="/hmblog/assets/js/114.2e526e4d.js"><link rel="prefetch" href="/hmblog/assets/js/115.221e2f65.js"><link rel="prefetch" href="/hmblog/assets/js/116.a7726179.js"><link rel="prefetch" href="/hmblog/assets/js/117.22075f73.js"><link rel="prefetch" href="/hmblog/assets/js/118.459f31e3.js"><link rel="prefetch" href="/hmblog/assets/js/119.f7a33a09.js"><link rel="prefetch" href="/hmblog/assets/js/120.8b58a340.js"><link rel="prefetch" href="/hmblog/assets/js/121.277e1f1e.js"><link rel="prefetch" href="/hmblog/assets/js/122.ec3ae934.js"><link rel="prefetch" href="/hmblog/assets/js/123.514ade54.js"><link rel="prefetch" href="/hmblog/assets/js/124.6b6c2b7d.js"><link rel="prefetch" href="/hmblog/assets/js/125.a7fb1fbe.js"><link rel="prefetch" href="/hmblog/assets/js/126.b5ef252a.js"><link rel="prefetch" href="/hmblog/assets/js/127.d8121d6d.js"><link rel="prefetch" href="/hmblog/assets/js/128.40963707.js"><link rel="prefetch" href="/hmblog/assets/js/129.bf256481.js"><link rel="prefetch" href="/hmblog/assets/js/130.0031ec91.js"><link rel="prefetch" href="/hmblog/assets/js/131.4fe99cc5.js"><link rel="prefetch" href="/hmblog/assets/js/132.fcf1a74b.js"><link rel="prefetch" href="/hmblog/assets/js/133.ff8e24a1.js"><link rel="prefetch" href="/hmblog/assets/js/134.db2d31f5.js"><link rel="prefetch" href="/hmblog/assets/js/135.b152d9b0.js"><link rel="prefetch" href="/hmblog/assets/js/136.936be57e.js"><link rel="prefetch" href="/hmblog/assets/js/137.48f9d2b5.js"><link rel="prefetch" href="/hmblog/assets/js/138.3bdb70b7.js"><link rel="prefetch" href="/hmblog/assets/js/139.2c511f09.js"><link rel="prefetch" href="/hmblog/assets/js/14.0ac4aea5.js"><link rel="prefetch" href="/hmblog/assets/js/140.5f00d305.js"><link rel="prefetch" href="/hmblog/assets/js/141.41c9f925.js"><link rel="prefetch" href="/hmblog/assets/js/142.b37e8f1d.js"><link rel="prefetch" href="/hmblog/assets/js/143.20c71a9e.js"><link rel="prefetch" href="/hmblog/assets/js/144.17cece65.js"><link rel="prefetch" href="/hmblog/assets/js/145.978e7516.js"><link rel="prefetch" href="/hmblog/assets/js/146.94bdfed5.js"><link rel="prefetch" href="/hmblog/assets/js/147.f9c95b0c.js"><link rel="prefetch" href="/hmblog/assets/js/148.355cbcf5.js"><link rel="prefetch" href="/hmblog/assets/js/149.b1e46aaf.js"><link rel="prefetch" href="/hmblog/assets/js/15.2cac15c3.js"><link rel="prefetch" href="/hmblog/assets/js/150.b5a35472.js"><link rel="prefetch" href="/hmblog/assets/js/151.d309c32e.js"><link rel="prefetch" href="/hmblog/assets/js/152.fb9a950d.js"><link rel="prefetch" href="/hmblog/assets/js/153.c231397c.js"><link rel="prefetch" href="/hmblog/assets/js/154.2c76a2e9.js"><link rel="prefetch" href="/hmblog/assets/js/155.ad43ee17.js"><link rel="prefetch" href="/hmblog/assets/js/156.b0fe3a29.js"><link rel="prefetch" href="/hmblog/assets/js/157.d085315f.js"><link rel="prefetch" href="/hmblog/assets/js/158.9f11fbf4.js"><link rel="prefetch" href="/hmblog/assets/js/159.178d8a8a.js"><link rel="prefetch" href="/hmblog/assets/js/16.41c97ec9.js"><link rel="prefetch" href="/hmblog/assets/js/160.e6a3b7e3.js"><link rel="prefetch" href="/hmblog/assets/js/161.b897eab6.js"><link rel="prefetch" href="/hmblog/assets/js/162.54114dbe.js"><link rel="prefetch" href="/hmblog/assets/js/163.156fce2c.js"><link rel="prefetch" href="/hmblog/assets/js/164.e44a107d.js"><link rel="prefetch" href="/hmblog/assets/js/165.50843d9b.js"><link rel="prefetch" href="/hmblog/assets/js/166.51cc166e.js"><link rel="prefetch" href="/hmblog/assets/js/167.1e241fd0.js"><link rel="prefetch" href="/hmblog/assets/js/168.1f0c33e5.js"><link rel="prefetch" href="/hmblog/assets/js/169.62546341.js"><link rel="prefetch" href="/hmblog/assets/js/17.29a60e10.js"><link rel="prefetch" href="/hmblog/assets/js/170.3e1d4983.js"><link rel="prefetch" href="/hmblog/assets/js/171.5975c042.js"><link rel="prefetch" href="/hmblog/assets/js/172.a172fe4f.js"><link rel="prefetch" href="/hmblog/assets/js/173.b7f30ce1.js"><link rel="prefetch" href="/hmblog/assets/js/174.cf213ee7.js"><link rel="prefetch" href="/hmblog/assets/js/175.fead80ee.js"><link rel="prefetch" href="/hmblog/assets/js/176.d8597cdf.js"><link rel="prefetch" href="/hmblog/assets/js/177.72596ae1.js"><link rel="prefetch" href="/hmblog/assets/js/178.d0c48b18.js"><link rel="prefetch" href="/hmblog/assets/js/179.d5c444fc.js"><link rel="prefetch" href="/hmblog/assets/js/18.27fd2b83.js"><link rel="prefetch" href="/hmblog/assets/js/180.2f29e719.js"><link rel="prefetch" href="/hmblog/assets/js/181.bb359567.js"><link rel="prefetch" href="/hmblog/assets/js/182.e140022f.js"><link rel="prefetch" href="/hmblog/assets/js/183.88c88131.js"><link rel="prefetch" href="/hmblog/assets/js/184.7dafb863.js"><link rel="prefetch" href="/hmblog/assets/js/185.6ee6fee4.js"><link rel="prefetch" href="/hmblog/assets/js/186.a58d3091.js"><link rel="prefetch" href="/hmblog/assets/js/187.06e4ac29.js"><link rel="prefetch" href="/hmblog/assets/js/188.4f58b234.js"><link rel="prefetch" href="/hmblog/assets/js/189.b7fcaad5.js"><link rel="prefetch" href="/hmblog/assets/js/19.e7351a57.js"><link rel="prefetch" href="/hmblog/assets/js/190.1ee24f3f.js"><link rel="prefetch" href="/hmblog/assets/js/191.71d1ed44.js"><link rel="prefetch" href="/hmblog/assets/js/192.8e13dbd5.js"><link rel="prefetch" href="/hmblog/assets/js/193.6ffdbe3c.js"><link rel="prefetch" href="/hmblog/assets/js/194.f3092777.js"><link rel="prefetch" href="/hmblog/assets/js/195.61518c26.js"><link rel="prefetch" href="/hmblog/assets/js/196.4749bfe4.js"><link rel="prefetch" href="/hmblog/assets/js/197.02f293f5.js"><link rel="prefetch" href="/hmblog/assets/js/198.66d067f8.js"><link rel="prefetch" href="/hmblog/assets/js/199.e713626b.js"><link rel="prefetch" href="/hmblog/assets/js/20.20706f57.js"><link rel="prefetch" href="/hmblog/assets/js/200.a0428ce1.js"><link rel="prefetch" href="/hmblog/assets/js/201.10f94064.js"><link rel="prefetch" href="/hmblog/assets/js/202.85104aab.js"><link rel="prefetch" href="/hmblog/assets/js/203.610baaad.js"><link rel="prefetch" href="/hmblog/assets/js/204.d7a56285.js"><link rel="prefetch" href="/hmblog/assets/js/205.e9c3d532.js"><link rel="prefetch" href="/hmblog/assets/js/21.0feb36e8.js"><link rel="prefetch" href="/hmblog/assets/js/22.40bc0c74.js"><link rel="prefetch" href="/hmblog/assets/js/23.3f7042f4.js"><link rel="prefetch" href="/hmblog/assets/js/24.ed563c46.js"><link rel="prefetch" href="/hmblog/assets/js/25.ac1b0e72.js"><link rel="prefetch" href="/hmblog/assets/js/26.683143d5.js"><link rel="prefetch" href="/hmblog/assets/js/27.f0066995.js"><link rel="prefetch" href="/hmblog/assets/js/28.d8aebbf6.js"><link rel="prefetch" href="/hmblog/assets/js/29.411fc063.js"><link rel="prefetch" href="/hmblog/assets/js/3.1300dadf.js"><link rel="prefetch" href="/hmblog/assets/js/30.2f75779a.js"><link rel="prefetch" href="/hmblog/assets/js/31.a195dbd7.js"><link rel="prefetch" href="/hmblog/assets/js/32.a4da846d.js"><link rel="prefetch" href="/hmblog/assets/js/33.cbaf45e6.js"><link rel="prefetch" href="/hmblog/assets/js/35.b991843f.js"><link rel="prefetch" href="/hmblog/assets/js/36.ae8fa883.js"><link rel="prefetch" href="/hmblog/assets/js/37.dc5b3f34.js"><link rel="prefetch" href="/hmblog/assets/js/38.2acfc275.js"><link rel="prefetch" href="/hmblog/assets/js/39.c2783769.js"><link rel="prefetch" href="/hmblog/assets/js/4.a36b649a.js"><link rel="prefetch" href="/hmblog/assets/js/40.b6871f20.js"><link rel="prefetch" href="/hmblog/assets/js/41.b9269303.js"><link rel="prefetch" href="/hmblog/assets/js/42.e8164e0c.js"><link rel="prefetch" href="/hmblog/assets/js/43.70ef46e5.js"><link rel="prefetch" href="/hmblog/assets/js/44.9331e0b2.js"><link rel="prefetch" href="/hmblog/assets/js/45.5feef070.js"><link rel="prefetch" href="/hmblog/assets/js/46.cbe15db5.js"><link rel="prefetch" href="/hmblog/assets/js/47.13b797de.js"><link rel="prefetch" href="/hmblog/assets/js/48.7030d96f.js"><link rel="prefetch" href="/hmblog/assets/js/49.21360ca4.js"><link rel="prefetch" href="/hmblog/assets/js/5.ade88313.js"><link rel="prefetch" href="/hmblog/assets/js/50.2278b4f1.js"><link rel="prefetch" href="/hmblog/assets/js/51.dfcce7fa.js"><link rel="prefetch" href="/hmblog/assets/js/52.411e6b71.js"><link rel="prefetch" href="/hmblog/assets/js/53.9f14e863.js"><link rel="prefetch" href="/hmblog/assets/js/54.ae21c7a9.js"><link rel="prefetch" href="/hmblog/assets/js/55.0b0dbecf.js"><link rel="prefetch" href="/hmblog/assets/js/56.2b3b9c9e.js"><link rel="prefetch" href="/hmblog/assets/js/57.eb5c4857.js"><link rel="prefetch" href="/hmblog/assets/js/58.5bb642a4.js"><link rel="prefetch" href="/hmblog/assets/js/59.310d4748.js"><link rel="prefetch" href="/hmblog/assets/js/6.3551780c.js"><link rel="prefetch" href="/hmblog/assets/js/60.43f50fd6.js"><link rel="prefetch" href="/hmblog/assets/js/61.bf7359ad.js"><link rel="prefetch" href="/hmblog/assets/js/62.bbc1a63f.js"><link rel="prefetch" href="/hmblog/assets/js/63.4f514386.js"><link rel="prefetch" href="/hmblog/assets/js/64.75891b13.js"><link rel="prefetch" href="/hmblog/assets/js/65.c594c5f0.js"><link rel="prefetch" href="/hmblog/assets/js/66.3b2e8434.js"><link rel="prefetch" href="/hmblog/assets/js/67.d21dd018.js"><link rel="prefetch" href="/hmblog/assets/js/68.3a1952eb.js"><link rel="prefetch" href="/hmblog/assets/js/69.4a9f3de5.js"><link rel="prefetch" href="/hmblog/assets/js/70.79851ca4.js"><link rel="prefetch" href="/hmblog/assets/js/71.6b0dd684.js"><link rel="prefetch" href="/hmblog/assets/js/72.194abe8d.js"><link rel="prefetch" href="/hmblog/assets/js/73.57d7aacb.js"><link rel="prefetch" href="/hmblog/assets/js/74.21d325f3.js"><link rel="prefetch" href="/hmblog/assets/js/75.5db4d81f.js"><link rel="prefetch" href="/hmblog/assets/js/77.5fb8fe74.js"><link rel="prefetch" href="/hmblog/assets/js/78.cbf908d6.js"><link rel="prefetch" href="/hmblog/assets/js/79.16b13beb.js"><link rel="prefetch" href="/hmblog/assets/js/8.1407b990.js"><link rel="prefetch" href="/hmblog/assets/js/80.b7f99985.js"><link rel="prefetch" href="/hmblog/assets/js/81.c5c33a8c.js"><link rel="prefetch" href="/hmblog/assets/js/82.1bb32711.js"><link rel="prefetch" href="/hmblog/assets/js/83.0126cbfc.js"><link rel="prefetch" href="/hmblog/assets/js/84.bf184586.js"><link rel="prefetch" href="/hmblog/assets/js/85.ed882d02.js"><link rel="prefetch" href="/hmblog/assets/js/86.00a6c023.js"><link rel="prefetch" href="/hmblog/assets/js/87.19ec978b.js"><link rel="prefetch" href="/hmblog/assets/js/88.da0b0fce.js"><link rel="prefetch" href="/hmblog/assets/js/89.1b3f0dc7.js"><link rel="prefetch" href="/hmblog/assets/js/9.7b6dd5b4.js"><link rel="prefetch" href="/hmblog/assets/js/90.5b446b43.js"><link rel="prefetch" href="/hmblog/assets/js/91.b7568648.js"><link rel="prefetch" href="/hmblog/assets/js/92.41c96c2a.js"><link rel="prefetch" href="/hmblog/assets/js/93.c88897c2.js"><link rel="prefetch" href="/hmblog/assets/js/94.1b8ca6ee.js"><link rel="prefetch" href="/hmblog/assets/js/95.ad838784.js"><link rel="prefetch" href="/hmblog/assets/js/96.8d479f68.js"><link rel="prefetch" href="/hmblog/assets/js/97.50826eb1.js"><link rel="prefetch" href="/hmblog/assets/js/98.bdb338cb.js"><link rel="prefetch" href="/hmblog/assets/js/99.4842effa.js"><link rel="prefetch" href="/hmblog/assets/js/vendors~docsearch.e480d9b8.js">
    <link rel="stylesheet" href="/hmblog/assets/css/0.styles.e7d53aa5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>å¯’æ¢¦çš„åšå®¢</h3> <p class="description" data-v-59e6cb88>å®å‰‘é”‹ä»ç£¨ç ºå‡ºï¼Œæ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥ã€‚</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>å¯’æ¢¦</span>
        Â Â 
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hmblog/" class="home-link router-link-active"><!----> <span class="site-name">å¯’æ¢¦çš„åšå®¢</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Python
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/basic.html" class="nav-link"><i class="undefined"></i>
  Python åŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/builtin-function.html" class="nav-link"><i class="undefined"></i>
  Python å†…ç½®å‡½æ•°çš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/function.html" class="nav-link"><i class="undefined"></i>
  Python å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/numpy.html" class="nav-link"><i class="undefined"></i>
  Python numpy
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/array-operation.html" class="nav-link"><i class="undefined"></i>
  Python æ•°ç»„æ“ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/use-library.html" class="nav-link"><i class="undefined"></i>
  Python å¸¸ç”¨åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/string-function.html" class="nav-link"><i class="undefined"></i>
  Python å­—ç¬¦ä¸²å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/use-pip-install.html" class="nav-link"><i class="undefined"></i>
  pip é‚£äº›äº‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/line-continue.html" class="nav-link"><i class="undefined"></i>
  Python ä¸­çš„è¡Œç»­è¡Œç¬¦
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/pandas-study.html" class="nav-link"><i class="undefined"></i>
  pandas åº“çš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-important.html" class="nav-link"><i class="undefined"></i>
  python å‡ ä¸ªå¸¸ç”¨åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-collect.html" class="nav-link"><i class="undefined"></i>
  python æ±‡æ€»
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-web.html" class="nav-link"><i class="undefined"></i>
  Python Webæ¡†æ¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¤§æ¨¡å‹åº”ç”¨å¼€å‘
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/transformer-basic.html" class="nav-link"><i class="undefined"></i>
  Transformer ç›¸å…³
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/basic-knowledge.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹åŸºç¡€æ¦‚å¿µ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/prompts.html" class="nav-link"><i class="undefined"></i>
  æç¤ºè¯å·¥ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/rag.html" class="nav-link"><i class="undefined"></i>
  æ£€ç´¢å¢å¼ºç”ŸæˆRAG
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/data-chunk.html" class="nav-link"><i class="undefined"></i>
  æ•°æ®åˆ†å—
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-langchain-rag.html" class="nav-link"><i class="undefined"></i>
  Langchain &amp; RAG
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-rag.html" class="nav-link"><i class="undefined"></i>
  RAG çŸ¥è¯†ç‚¹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-rag-pain.html" class="nav-link"><i class="undefined"></i>
  RAG ç—›ç‚¹åˆ†æ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/langchain-study.html" class="nav-link"><i class="undefined"></i>
  Langchain use
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/vector-database.html" class="nav-link"><i class="undefined"></i>
  å‘é‡æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/first-model-project.html" class="nav-link"><i class="undefined"></i>
  RAG é¡¹ç›®å®æˆ˜
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-function-calling.html" class="nav-link"><i class="undefined"></i>
  Function Calling
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/agent.html" class="nav-link"><i class="undefined"></i>
  Agent ç›¸å…³
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/langchain-prompt.html" class="nav-link"><i class="undefined"></i>
  LangChain Promptçš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-english.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹ç›¸å…³çš„è‹±è¯­è¯æ±‡
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/rl.html" class="nav-link"><i class="undefined"></i>
  å¼ºåŒ–å­¦ä¹ 
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/peft.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹å¾®è°ƒ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/quantization.html" class="nav-link"><i class="undefined"></i>
  æ¨¡å‹é‡åŒ–
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/vLLM-intro.html" class="nav-link"><i class="undefined"></i>
  vLLM
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-pytorch.html" class="nav-link"><i class="undefined"></i>
  PyTorch Dataset VS Huggingface Dataset
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-train-process.html" class="nav-link"><i class="undefined"></i>
  ä»é›¶è®­ç»ƒä¸€ä¸ªå¤§æ¨¡å‹çš„å®Œæ•´æµç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/basic-aigc.html" class="nav-link"><i class="undefined"></i>
  ç”Ÿæˆå¼AI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¼ºå¤§çš„MCP
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/mcp-knowledge.html" class="nav-link"><i class="undefined"></i>
  MCP æ˜¯ä»€ä¹ˆ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/ide-mcp-server.html" class="nav-link"><i class="undefined"></i>
  IDE ä½¿ç”¨MCP Serverå®æ“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/mcp-tool.html" class="nav-link"><i class="undefined"></i>
  å¸¸è§çš„MCPå·¥å…·
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      ç®—æ³•
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/sort.html" class="nav-link"><i class="undefined"></i>
  æ’åºç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/double-pointer.html" class="nav-link"><i class="undefined"></i>
  åŒæŒ‡é’ˆç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/binary-tree.html" class="nav-link"><i class="undefined"></i>
  äºŒå‰æ ‘
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/receive-rain.html" class="nav-link"><i class="undefined"></i>
  æ¥é›¨æ°´
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/dynamic-plan.html" class="nav-link"><i class="undefined"></i>
  åŠ¨æ€è§„åˆ’
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/greedy.html" class="nav-link"><i class="undefined"></i>
  è´ªå¿ƒç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/longasc-sequence.html" class="nav-link"><i class="undefined"></i>
  æœ€é•¿ä¸Šå‡å­åºåˆ—
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/binary-search.html" class="nav-link"><i class="undefined"></i>
  äºŒåˆ†æŸ¥æ‰¾
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/reverse-list.html" class="nav-link"><i class="undefined"></i>
  åè½¬é“¾è¡¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/del-single-list.html" class="nav-link"><i class="undefined"></i>
  åˆ é™¤å•é“¾è¡¨-é›†åˆ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/other.html" class="nav-link"><i class="undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/compare-al.html" class="nav-link"><i class="undefined"></i>
  mä¸ªæ•°ï¼Œæœ€å¤šç”¨næ¬¡æ¯”è¾ƒï¼Œæ‰¾å‡ºç¬¬äºŒå¤§çš„æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/effect-bracket.html" class="nav-link"><i class="undefined"></i>
  æœ‰æ•ˆçš„æ‹¬å·
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å…¶ä»–
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/other/ai-agent.html" class="nav-link"><i class="undefined"></i>
  AIé¡¹ç›®
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/conda.html" class="nav-link"><i class="undefined"></i>
  Conda ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/using-packages.html" class="nav-link"><i class="undefined"></i>
  Pytorch æ¡†æ¶ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/pytorch-know.html" class="nav-link"><i class="undefined"></i>
  Pytorch æ¡†æ¶çŸ¥è¯†ç‚¹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-learn.html" class="nav-link"><i class="undefined"></i>
  transformeråº“ä¸­é‚£äº›å¸¸ç”¨å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-collect.html" class="nav-link"><i class="undefined"></i>
  transformeråº“å­¦ä¹ å“ªäº›äº‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-1.html" class="nav-link"><i class="undefined"></i>
  transformer ä½¿ç”¨T5æ¨¡å‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-2.html" class="nav-link"><i class="undefined"></i>
  torch DataLoader
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-3.html" class="nav-link"><i class="undefined"></i>
  è®¾ç½®éšæœºç§å­
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/model-refrence.html" class="nav-link"><i class="undefined"></i>
  ä¼˜ç§€çš„å‚è€ƒæ–‡æ¡£
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/git-operate.html" class="nav-link"><i class="undefined"></i>
  git æ“ä½œå‘½ä»¤
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/fine-tuning-adapters.html" class="nav-link"><i class="undefined"></i>
  PEFT ä¹‹Adapters
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/swanLab-info.html" class="nav-link"><i class="undefined"></i>
  æ·±åº¦å­¦ä¹ ä¹‹SwanLab
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/lora-0-1.html" class="nav-link"><i class="undefined"></i>
  ä»0åˆ°1æ‰‹æ’•LoRAç±»
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/rag-question-compare.html" class="nav-link"><i class="undefined"></i>
  ä¸´æ—¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å…³äºæˆ‘
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hmyjyghh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/ghh_" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/cool-62-29/columns" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  çŸ¥ä¹
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://hmyjyghh.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><!----> <h3 class="name" data-v-1fad0c41>
    å¯’æ¢¦
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>129</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>4</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Python
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/basic.html" class="nav-link"><i class="undefined"></i>
  Python åŸºç¡€
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/builtin-function.html" class="nav-link"><i class="undefined"></i>
  Python å†…ç½®å‡½æ•°çš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/function.html" class="nav-link"><i class="undefined"></i>
  Python å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/numpy.html" class="nav-link"><i class="undefined"></i>
  Python numpy
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/array-operation.html" class="nav-link"><i class="undefined"></i>
  Python æ•°ç»„æ“ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/use-library.html" class="nav-link"><i class="undefined"></i>
  Python å¸¸ç”¨åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/string-function.html" class="nav-link"><i class="undefined"></i>
  Python å­—ç¬¦ä¸²å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/use-pip-install.html" class="nav-link"><i class="undefined"></i>
  pip é‚£äº›äº‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/line-continue.html" class="nav-link"><i class="undefined"></i>
  Python ä¸­çš„è¡Œç»­è¡Œç¬¦
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/pandas-study.html" class="nav-link"><i class="undefined"></i>
  pandas åº“çš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-important.html" class="nav-link"><i class="undefined"></i>
  python å‡ ä¸ªå¸¸ç”¨åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-collect.html" class="nav-link"><i class="undefined"></i>
  python æ±‡æ€»
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/pystudy/python-web.html" class="nav-link"><i class="undefined"></i>
  Python Webæ¡†æ¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¤§æ¨¡å‹åº”ç”¨å¼€å‘
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/transformer-basic.html" class="nav-link"><i class="undefined"></i>
  Transformer ç›¸å…³
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/basic-knowledge.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹åŸºç¡€æ¦‚å¿µ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/prompts.html" class="nav-link"><i class="undefined"></i>
  æç¤ºè¯å·¥ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/rag.html" class="nav-link"><i class="undefined"></i>
  æ£€ç´¢å¢å¼ºç”ŸæˆRAG
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/data-chunk.html" class="nav-link"><i class="undefined"></i>
  æ•°æ®åˆ†å—
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-langchain-rag.html" class="nav-link"><i class="undefined"></i>
  Langchain &amp; RAG
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-rag.html" class="nav-link"><i class="undefined"></i>
  RAG çŸ¥è¯†ç‚¹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-rag-pain.html" class="nav-link"><i class="undefined"></i>
  RAG ç—›ç‚¹åˆ†æ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/langchain-study.html" class="nav-link"><i class="undefined"></i>
  Langchain use
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/vector-database.html" class="nav-link"><i class="undefined"></i>
  å‘é‡æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/first-model-project.html" class="nav-link"><i class="undefined"></i>
  RAG é¡¹ç›®å®æˆ˜
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-function-calling.html" class="nav-link"><i class="undefined"></i>
  Function Calling
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/agent.html" class="nav-link"><i class="undefined"></i>
  Agent ç›¸å…³
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/langchain-prompt.html" class="nav-link"><i class="undefined"></i>
  LangChain Promptçš„ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-english.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹ç›¸å…³çš„è‹±è¯­è¯æ±‡
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/rl.html" class="nav-link"><i class="undefined"></i>
  å¼ºåŒ–å­¦ä¹ 
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/peft.html" class="nav-link"><i class="undefined"></i>
  å¤§æ¨¡å‹å¾®è°ƒ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/quantization.html" class="nav-link"><i class="undefined"></i>
  æ¨¡å‹é‡åŒ–
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/vLLM-intro.html" class="nav-link"><i class="undefined"></i>
  vLLM
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-pytorch.html" class="nav-link"><i class="undefined"></i>
  PyTorch Dataset VS Huggingface Dataset
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/model-train-process.html" class="nav-link"><i class="undefined"></i>
  ä»é›¶è®­ç»ƒä¸€ä¸ªå¤§æ¨¡å‹çš„å®Œæ•´æµç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/modelstudy/basic-aigc.html" class="nav-link"><i class="undefined"></i>
  ç”Ÿæˆå¼AI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å¼ºå¤§çš„MCP
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/mcp-knowledge.html" class="nav-link"><i class="undefined"></i>
  MCP æ˜¯ä»€ä¹ˆ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/ide-mcp-server.html" class="nav-link"><i class="undefined"></i>
  IDE ä½¿ç”¨MCP Serverå®æ“
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/mcpstudy/mcp-tool.html" class="nav-link"><i class="undefined"></i>
  å¸¸è§çš„MCPå·¥å…·
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      ç®—æ³•
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/sort.html" class="nav-link"><i class="undefined"></i>
  æ’åºç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/double-pointer.html" class="nav-link"><i class="undefined"></i>
  åŒæŒ‡é’ˆç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/binary-tree.html" class="nav-link"><i class="undefined"></i>
  äºŒå‰æ ‘
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/receive-rain.html" class="nav-link"><i class="undefined"></i>
  æ¥é›¨æ°´
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/dynamic-plan.html" class="nav-link"><i class="undefined"></i>
  åŠ¨æ€è§„åˆ’
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/greedy.html" class="nav-link"><i class="undefined"></i>
  è´ªå¿ƒç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/longasc-sequence.html" class="nav-link"><i class="undefined"></i>
  æœ€é•¿ä¸Šå‡å­åºåˆ—
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/binary-search.html" class="nav-link"><i class="undefined"></i>
  äºŒåˆ†æŸ¥æ‰¾
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/reverse-list.html" class="nav-link"><i class="undefined"></i>
  åè½¬é“¾è¡¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/del-single-list.html" class="nav-link"><i class="undefined"></i>
  åˆ é™¤å•é“¾è¡¨-é›†åˆ
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/other.html" class="nav-link"><i class="undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/compare-al.html" class="nav-link"><i class="undefined"></i>
  mä¸ªæ•°ï¼Œæœ€å¤šç”¨næ¬¡æ¯”è¾ƒï¼Œæ‰¾å‡ºç¬¬äºŒå¤§çš„æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/algorithm/effect-bracket.html" class="nav-link"><i class="undefined"></i>
  æœ‰æ•ˆçš„æ‹¬å·
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å…¶ä»–
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hmblog/other/ai-agent.html" class="nav-link"><i class="undefined"></i>
  AIé¡¹ç›®
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/conda.html" class="nav-link"><i class="undefined"></i>
  Conda ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/using-packages.html" class="nav-link"><i class="undefined"></i>
  Pytorch æ¡†æ¶ä½¿ç”¨
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/pytorch-know.html" class="nav-link"><i class="undefined"></i>
  Pytorch æ¡†æ¶çŸ¥è¯†ç‚¹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-learn.html" class="nav-link"><i class="undefined"></i>
  transformeråº“ä¸­é‚£äº›å¸¸ç”¨å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-collect.html" class="nav-link"><i class="undefined"></i>
  transformeråº“å­¦ä¹ å“ªäº›äº‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-1.html" class="nav-link"><i class="undefined"></i>
  transformer ä½¿ç”¨T5æ¨¡å‹
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-2.html" class="nav-link"><i class="undefined"></i>
  torch DataLoader
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/transformer-3.html" class="nav-link"><i class="undefined"></i>
  è®¾ç½®éšæœºç§å­
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/model-refrence.html" class="nav-link"><i class="undefined"></i>
  ä¼˜ç§€çš„å‚è€ƒæ–‡æ¡£
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/git-operate.html" class="nav-link"><i class="undefined"></i>
  git æ“ä½œå‘½ä»¤
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/fine-tuning-adapters.html" class="nav-link"><i class="undefined"></i>
  PEFT ä¹‹Adapters
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/swanLab-info.html" class="nav-link"><i class="undefined"></i>
  æ·±åº¦å­¦ä¹ ä¹‹SwanLab
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/lora-0-1.html" class="nav-link"><i class="undefined"></i>
  ä»0åˆ°1æ‰‹æ’•LoRAç±»
</a></li><li class="dropdown-item"><!----> <a href="/hmblog/other/rag-question-compare.html" class="nav-link"><i class="undefined"></i>
  ä¸´æ—¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      å…³äºæˆ‘
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/hmyjyghh" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/ghh_" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/cool-62-29/columns" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  çŸ¥ä¹
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://hmyjyghh.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88></h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>å¯’æ¢¦</span>
        Â Â 
        <!---->
        2025
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">OM é”™è¯¯</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>å¯’æ¢¦</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h2 id="om-é”™è¯¯"><a href="#om-é”™è¯¯" class="header-anchor">#</a> OM é”™è¯¯</h2> <div class="language- extra-class"><pre class="language-text"><code>OutOfMemoryError: CUDA out of memory. Tried to allocate 260.00 MiB. GPU 0 has a total capacity of 23.55 GiB of which 225.00 MiB is free. Including non-PyTorch memory, this process has 23.32 GiB memory in use. Of the allocated memory 22.80 GiB is allocated by PyTorch, and 149.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
</code></pre></div><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ <strong>GPU å†…å­˜ä¸è¶³</strong> é”™è¯¯ã€‚ä½ çš„ GPU æœ‰ 24GB å†…å­˜ï¼Œä½†å·²ç»è¢«å ç”¨äº† 23.32GBï¼Œåªå‰©ä¸‹ 225MB å¯ç”¨ã€‚</p> <h2 id="ğŸ”§-ç«‹å³è§£å†³æ–¹æ¡ˆ"><a href="#ğŸ”§-ç«‹å³è§£å†³æ–¹æ¡ˆ" class="header-anchor">#</a> ğŸ”§ ç«‹å³è§£å†³æ–¹æ¡ˆ</h2> <h3 id="æ–¹æ¡ˆ1-æ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°"><a href="#æ–¹æ¡ˆ1-æ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°" class="header-anchor">#</a> æ–¹æ¡ˆ1ï¼šæ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> gc

<span class="token comment"># æ¸…ç†GPUå†…å­˜</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
gc<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># æ£€æŸ¥å½“å‰GPUå†…å­˜ä½¿ç”¨æƒ…å†µ</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GPUå†…å­˜ä½¿ç”¨: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GPUå†…å­˜ä¿ç•™: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_reserved<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># å‡å°‘æ‰¹æ¬¡å¤§å°</span>
training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
  output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
  per_device_train_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment"># å¤§å¹…å‡å°‘æ‰¹æ¬¡å¤§å°</span>
  per_device_eval_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
  dataloader_drop_last<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸¢å¼ƒä¸å®Œæ•´çš„æ‰¹æ¬¡</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–¹æ¡ˆ2-ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯"><a href="#æ–¹æ¡ˆ2-ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯" class="header-anchor">#</a> æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ¢¯åº¦ç´¯ç§¯</h3> <div class="language-python extra-class"><pre class="language-python"><code>training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>      <span class="token comment"># å°æ‰¹æ¬¡</span>
    gradient_accumulation_steps<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>       <span class="token comment"># æ¢¯åº¦ç´¯ç§¯</span>
    per_device_eval_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    dataloader_drop_last<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–¹æ¡ˆ3-å¯ç”¨å†…å­˜ä¼˜åŒ–"><a href="#æ–¹æ¡ˆ3-å¯ç”¨å†…å­˜ä¼˜åŒ–" class="header-anchor">#</a> æ–¹æ¡ˆ3ï¼šå¯ç”¨å†…å­˜ä¼˜åŒ–</h3> <div class="language-python extra-class"><pre class="language-python"><code>training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    gradient_accumulation_steps<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token comment"># å†…å­˜ä¼˜åŒ–é€‰é¡¹</span>
    dataloader_pin_memory<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># ç¦ç”¨å†…å­˜é”å®š</span>
    fp16<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒ</span>
    <span class="token comment"># æˆ–è€…ä½¿ç”¨bf16ï¼ˆå¦‚æœGPUæ”¯æŒï¼‰</span>
    <span class="token comment"># bf16=True,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="ğŸ¯-å®Œæ•´çš„ä¼˜åŒ–é…ç½®"><a href="#ğŸ¯-å®Œæ•´çš„ä¼˜åŒ–é…ç½®" class="header-anchor">#</a> ğŸ¯ å®Œæ•´çš„ä¼˜åŒ–é…ç½®</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> transformers <span class="token keyword">import</span> TrainingArguments<span class="token punctuation">,</span> Trainer

<span class="token comment"># ä¼˜åŒ–çš„è®­ç»ƒå‚æ•°</span>
training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
    overwrite_output_dir<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    
    <span class="token comment"># æ‰¹æ¬¡å¤§å°ä¼˜åŒ–</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>      <span class="token comment"># å°æ‰¹æ¬¡</span>
    per_device_eval_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    gradient_accumulation_steps<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>      <span class="token comment"># ç­‰æ•ˆæ‰¹æ¬¡å¤§å° = 2 * 8 = 16</span>
    
    <span class="token comment"># å†…å­˜ä¼˜åŒ–</span>
    dataloader_drop_last<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    dataloader_pin_memory<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    fp16<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                          <span class="token comment"># æ··åˆç²¾åº¦è®­ç»ƒ</span>
    
    <span class="token comment"># è®­ç»ƒå‚æ•°</span>
    num_train_epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
    learning_rate<span class="token operator">=</span><span class="token number">2e-5</span><span class="token punctuation">,</span>
    warmup_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    weight_decay<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>
    
    <span class="token comment"># ä¿å­˜å’Œæ—¥å¿—</span>
    logging_dir<span class="token operator">=</span><span class="token string">&quot;./logs&quot;</span><span class="token punctuation">,</span>
    logging_steps<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>
    save_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    eval_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    
    <span class="token comment"># é˜²æ­¢å†…å­˜æ³„æ¼</span>
    remove_unused_columns<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    label_names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;labels&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="ğŸ”§-é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯"><a href="#ğŸ”§-é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯" class="header-anchor">#</a> ğŸ”§ é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯</h2> <h3 id="æ–¹æ¡ˆ4-ä½¿ç”¨deepspeed-æ¨èç”¨äºå¤§æ¨¡å‹"><a href="#æ–¹æ¡ˆ4-ä½¿ç”¨deepspeed-æ¨èç”¨äºå¤§æ¨¡å‹" class="header-anchor">#</a> æ–¹æ¡ˆ4ï¼šä½¿ç”¨DeepSpeedï¼ˆæ¨èç”¨äºå¤§æ¨¡å‹ï¼‰</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># åˆ›å»ºdeepspeedé…ç½®</span>
deepspeed_config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;fp16&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;optimizer&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;AdamW&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;params&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;lr&quot;</span><span class="token punctuation">:</span> <span class="token number">2e-5</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;zero_optimization&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;stage&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨ZeROç¬¬äºŒé˜¶æ®µ</span>
        <span class="token string">&quot;offload_optimizer&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;device&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cpu&quot;</span>  <span class="token comment"># å°†ä¼˜åŒ–å™¨å¸è½½åˆ°CPU</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;train_batch_size&quot;</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    <span class="token string">&quot;gradient_accumulation_steps&quot;</span><span class="token punctuation">:</span> <span class="token number">8</span>
<span class="token punctuation">}</span>

training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    deepspeed<span class="token operator">=</span>deepspeed_config<span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨DeepSpeed</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–¹æ¡ˆ5-æ¨¡å‹å†…å­˜ä¼˜åŒ–"><a href="#æ–¹æ¡ˆ5-æ¨¡å‹å†…å­˜ä¼˜åŒ–" class="header-anchor">#</a> æ–¹æ¡ˆ5ï¼šæ¨¡å‹å†…å­˜ä¼˜åŒ–</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> transformers <span class="token keyword">import</span> AutoModelForTokenClassification

<span class="token comment"># åŠ è½½æ¨¡å‹æ—¶å¯ç”¨å†…å­˜ä¼˜åŒ–</span>
model <span class="token operator">=</span> AutoModelForTokenClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>
    <span class="token string">&quot;bert-base-chinese&quot;</span><span class="token punctuation">,</span>
    num_labels<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>label2id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    id2label<span class="token operator">=</span>id2label<span class="token punctuation">,</span>
    label2id<span class="token operator">=</span>label2id<span class="token punctuation">,</span>
    <span class="token comment"># å†…å­˜ä¼˜åŒ–</span>
    torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">,</span>  <span class="token comment"># ä½¿ç”¨åŠç²¾åº¦</span>
<span class="token punctuation">)</span>

<span class="token comment"># æˆ–è€…åŠ¨æ€é‡åŒ–</span>
model <span class="token operator">=</span> model<span class="token punctuation">.</span>half<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºåŠç²¾åº¦</span>
</code></pre></div><h2 id="ğŸš€-ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ"><a href="#ğŸš€-ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ" class="header-anchor">#</a> ğŸš€ ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># ç«‹å³æ‰§è¡Œçš„å®Œæ•´æ–¹æ¡ˆ</span>
<span class="token keyword">import</span> torch
<span class="token keyword">import</span> gc

<span class="token comment"># 1. æ¸…ç†å†…å­˜</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
gc<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 2. è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆåœ¨ä»£ç å¼€å¤´ï¼‰</span>
<span class="token keyword">import</span> os
os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">&quot;PYTORCH_CUDA_ALLOC_CONF&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;expandable_segments:True&quot;</span>

<span class="token comment"># 3. æœ€å°åŒ–æ‰¹æ¬¡å¤§å°</span>
training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./results&quot;</span><span class="token punctuation">,</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>      <span class="token comment"># æœ€å°æ‰¹æ¬¡</span>
    gradient_accumulation_steps<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>     <span class="token comment"># ç´¯ç§¯åˆ°16</span>
    per_device_eval_batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    dataloader_drop_last<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    dataloader_pin_memory<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    fp16<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    remove_unused_columns<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    num_train_epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
    learning_rate<span class="token operator">=</span><span class="token number">2e-5</span><span class="token punctuation">,</span>
    logging_steps<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>
    save_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># 4. åˆ›å»ºTrainer</span>
trainer <span class="token operator">=</span> Trainer<span class="token punctuation">(</span>
    model<span class="token operator">=</span>model<span class="token punctuation">,</span>
    args<span class="token operator">=</span>training_args<span class="token punctuation">,</span>
    train_dataset<span class="token operator">=</span>train_dataset<span class="token punctuation">,</span>
    eval_dataset<span class="token operator">=</span>eval_dataset<span class="token punctuation">,</span>
    tokenizer<span class="token operator">=</span>tokenizer<span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># 5. å¼€å§‹è®­ç»ƒ</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    trainer<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">&quot;out of memory&quot;</span> <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å†…å­˜ä»ç„¶ä¸è¶³ï¼Œå°è¯•è¿›ä¸€æ­¥ä¼˜åŒ–...&quot;</span><span class="token punctuation">)</span>
        <span class="token comment"># è¿›ä¸€æ­¥å‡å°‘æ‰¹æ¬¡å¤§å°æˆ–ä½¿ç”¨CPUè®­ç»ƒ</span>
</code></pre></div><h2 id="ğŸ’¡-é¢„é˜²æªæ–½"><a href="#ğŸ’¡-é¢„é˜²æªæ–½" class="header-anchor">#</a> ğŸ’¡ é¢„é˜²æªæ–½</h2> <h3 id="ç›‘æ§gpuå†…å­˜"><a href="#ç›‘æ§gpuå†…å­˜" class="header-anchor">#</a> ç›‘æ§GPUå†…å­˜</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_gpu_memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²åˆ†é…: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²ä¿ç•™: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_reserved<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æœ€å¤§å·²åˆ†é…: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>max_memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># åœ¨è®­ç»ƒå¾ªç¯ä¸­å®šæœŸè°ƒç”¨</span>
print_gpu_memory<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="ä½¿ç”¨æ›´å°çš„æ¨¡å‹"><a href="#ä½¿ç”¨æ›´å°çš„æ¨¡å‹" class="header-anchor">#</a> ä½¿ç”¨æ›´å°çš„æ¨¡å‹</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># å¦‚æœä»ç„¶å†…å­˜ä¸è¶³ï¼Œä½¿ç”¨æ›´å°çš„æ¨¡å‹</span>
<span class="token keyword">from</span> transformers <span class="token keyword">import</span> AutoModelForTokenClassification

model <span class="token operator">=</span> AutoModelForTokenClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>
  <span class="token string">&quot;hfl/chinese-bert-wwm-ext&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># æ›´å°çš„ä¸­æ–‡æ¨¡å‹</span>
  <span class="token comment"># æˆ–è€… &quot;hfl/chinese-roberta-wwm-ext&quot;</span>
  num_labels<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>label2id<span class="token punctuation">)</span><span class="token punctuation">,</span>
  id2label<span class="token operator">=</span>id2label<span class="token punctuation">,</span>
  label2id<span class="token operator">=</span>label2id<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="ğŸ¯-æ¨èæ‰§è¡Œé¡ºåº"><a href="#ğŸ¯-æ¨èæ‰§è¡Œé¡ºåº" class="header-anchor">#</a> ğŸ¯ æ¨èæ‰§è¡Œé¡ºåº</h2> <ol><li><strong>ç«‹å³æ‰§è¡Œ</strong>ï¼šæ–¹æ¡ˆ1 + æ–¹æ¡ˆ3ï¼ˆæ¸…ç†å†…å­˜ + å°æ‰¹æ¬¡ + FP16ï¼‰</li> <li><strong>å¦‚æœä»ç„¶OOM</strong>ï¼šæ·»åŠ æ–¹æ¡ˆ4ï¼ˆDeepSpeedï¼‰</li> <li><strong>æœ€åæ‰‹æ®µ</strong>ï¼šä½¿ç”¨æ›´å°çš„æ¨¡å‹æˆ–CPUè®­ç»ƒ</li></ol> <p>é€‰æ‹©å…¶ä¸­ä¸€ä¸ªç»„åˆæ–¹æ¡ˆåº”è¯¥èƒ½è§£å†³ä½ çš„å†…å­˜é—®é¢˜ï¼</p> <h2 id="omé”™è¯¯-æ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ"><a href="#omé”™è¯¯-æ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ" class="header-anchor">#</a> OMé”™è¯¯ï¼Œæ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ</h2> <div class="language-py extra-class"><pre class="language-py"><code><span class="token comment"># åœ¨å¼€å§‹è®­ç»ƒå‰æ¸…ç†å†…å­˜</span>
<span class="token keyword">import</span> torch
<span class="token keyword">import</span> gc

<span class="token comment"># æ¸…ç†GPUå†…å­˜</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
gc<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># æ£€æŸ¥å¯ç”¨å†…å­˜</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;GPUå†…å­˜ä½¿ç”¨æƒ…å†µ:&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²åˆ†é…: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²ç¼“å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_reserved<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><p>ä»æ‚¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µæ¥çœ‹ï¼Œæˆ‘å‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼š</p> <h2 id="å†…å­˜åˆ†æ"><a href="#å†…å­˜åˆ†æ" class="header-anchor">#</a> å†…å­˜åˆ†æ</h2> <div class="language- extra-class"><pre class="language-text"><code>å·²åˆ†é…: 4.17 GB  (å®é™…ä½¿ç”¨çš„GPUå†…å­˜)
å·²ç¼“å­˜: 6.66 GB  (é¢„åˆ†é…çš„ç¼“å­˜å†…å­˜)
å‰©ä½™å¯ç”¨: çº¦ 12.72 GB (24GB - 4.17GB - 6.66GB)
</code></pre></div><p><strong>å…³é”®é—®é¢˜</strong>ï¼šæ¨¡å‹åŠ è½½åå·²ç»å ç”¨äº†4.17GBï¼Œä½†è®­ç»ƒå¼€å§‹æ—¶ä¼šéœ€è¦æ›´å¤šå†…å­˜ç”¨äºå‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œä¼˜åŒ–å™¨çŠ¶æ€ã€‚</p> <h2 id="å…·ä½“é—®é¢˜åˆ†æ"><a href="#å…·ä½“é—®é¢˜åˆ†æ" class="header-anchor">#</a> å…·ä½“é—®é¢˜åˆ†æ</h2> <ol><li><strong>æ¨¡å‹å‚æ•°</strong>ï¼š7Bæ¨¡å‹åœ¨float16ä¸‹çº¦éœ€è¦14GB</li> <li><strong>ä¼˜åŒ–å™¨çŠ¶æ€</strong>ï¼šAdamä¼˜åŒ–å™¨éœ€è¦2å€æ¨¡å‹å‚æ•°å†…å­˜</li> <li><strong>æ¿€æ´»å€¼/æ¢¯åº¦</strong>ï¼šéœ€è¦é¢å¤–å†…å­˜</li> <li><strong>å½“å‰çŠ¶æ€</strong>ï¼šæ¨¡å‹åªéƒ¨åˆ†åŠ è½½åˆ°GPU</li></ol> <h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="header-anchor">#</a> è§£å†³æ–¹æ¡ˆ</h2> <h3 id="æ–¹æ¡ˆ1-ç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½"><a href="#æ–¹æ¡ˆ1-ç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½" class="header-anchor">#</a> æ–¹æ¡ˆ1ï¼šç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> torch
<span class="token keyword">import</span> gc

<span class="token comment"># å¼ºåˆ¶æ¸…ç†ç¼“å­˜</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
gc<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;æ¸…ç†åå†…å­˜:&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²åˆ†é…: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;å·²ç¼“å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_reserved<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–¹æ¡ˆ2-ä½¿ç”¨æ›´å°çš„æ¨¡å‹-æ¨è"><a href="#æ–¹æ¡ˆ2-ä½¿ç”¨æ›´å°çš„æ¨¡å‹-æ¨è" class="header-anchor">#</a> æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ›´å°çš„æ¨¡å‹ï¼ˆæ¨èï¼‰</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># åˆ‡æ¢åˆ°æ›´å°çš„æ¨¡å‹</span>
small_model_name <span class="token operator">=</span> <span class="token string">&quot;Qwen/Qwen2.5-1.5B&quot;</span>  <span class="token comment"># æˆ– &quot;Qwen/Qwen2.5-0.5B&quot;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;åˆ‡æ¢åˆ°æ›´å°çš„æ¨¡å‹: </span><span class="token interpolation"><span class="token punctuation">{</span>small_model_name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># é‡æ–°åŠ è½½tokenizerå’Œæ¨¡å‹</span>
tokenizer <span class="token operator">=</span> AutoTokenizer<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>small_model_name<span class="token punctuation">)</span>
model <span class="token operator">=</span> AutoModelForTokenClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>
    small_model_name<span class="token punctuation">,</span> 
    num_labels<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>label2id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    id2label<span class="token operator">=</span>id2label<span class="token punctuation">,</span>
    label2id<span class="token operator">=</span>label2id<span class="token punctuation">,</span>
    torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">,</span>
    device_map<span class="token operator">=</span><span class="token string">&quot;auto&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="æ–¹æ¡ˆ3-ä¼˜åŒ–æ•°æ®åŠ è½½"><a href="#æ–¹æ¡ˆ3-ä¼˜åŒ–æ•°æ®åŠ è½½" class="header-anchor">#</a> æ–¹æ¡ˆ3ï¼šä¼˜åŒ–æ•°æ®åŠ è½½</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># è¿›ä¸€æ­¥ä¼˜åŒ–æ•°æ®å‚æ•°</span>
training_args <span class="token operator">=</span> TrainingArguments<span class="token punctuation">(</span>
    output_dir<span class="token operator">=</span><span class="token string">&quot;./qwen-ner&quot;</span><span class="token punctuation">,</span>
    overwrite_output_dir<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    num_train_epochs<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>
    per_device_train_batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># å¿…é¡»ä¸º1</span>
    per_device_eval_batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    gradient_accumulation_steps<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>  <span class="token comment"># å¢åŠ æ¢¯åº¦ç´¯ç§¯</span>
    save_strategy<span class="token operator">=</span><span class="token string">&quot;steps&quot;</span><span class="token punctuation">,</span>
    eval_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>  <span class="token comment"># å‡å°‘è¯„ä¼°é¢‘ç‡</span>
    save_steps<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>
    logging_steps<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    learning_rate<span class="token operator">=</span><span class="token number">2e-4</span><span class="token punctuation">,</span>
    fp16<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    dataloader_pin_memory<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    remove_unused_columns<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token comment"># æ·»åŠ å†…å­˜ä¼˜åŒ–å‚æ•°</span>
    dataloader_num_workers<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment"># é¿å…å¤šè¿›ç¨‹å†…å­˜å¼€é”€</span>
    no_cuda<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment"># ä¼˜åŒ–collate_fnï¼Œå‡å°åºåˆ—é•¿åº¦</span>
<span class="token keyword">def</span> <span class="token function">collote_fn_memory_optimized</span><span class="token punctuation">(</span>batch_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
    batch_sentence <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'sentence'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>  <span class="token comment"># é™åˆ¶å¥å­é•¿åº¦</span>
    batch_char_labels <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'char_labels'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>
    
    batch_inputs <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>
        batch_sentence<span class="token punctuation">,</span>
        padding<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>  <span class="token comment"># è¿›ä¸€æ­¥å‡å°åºåˆ—é•¿åº¦</span>
        return_tensors<span class="token operator">=</span><span class="token string">&quot;pt&quot;</span><span class="token punctuation">,</span>
        is_split_into_words<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># å…¶ä½™ä»£ç ä¸å˜...</span>
    aligned_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> char_labels <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>batch_char_labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        word_ids <span class="token operator">=</span> batch_inputs<span class="token punctuation">.</span>word_ids<span class="token punctuation">(</span>batch_index<span class="token operator">=</span>i<span class="token punctuation">)</span>
        token_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> word_idx <span class="token keyword">in</span> word_ids<span class="token punctuation">:</span>
            <span class="token keyword">if</span> word_idx <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label2id<span class="token punctuation">[</span>char_labels<span class="token punctuation">[</span>word_idx<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        aligned_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token_labels<span class="token punctuation">)</span>
    
    batch_inputs<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>aligned_labels<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> batch_inputs
</code></pre></div><h3 id="æ–¹æ¡ˆ4-åˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ"><a href="#æ–¹æ¡ˆ4-åˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ" class="header-anchor">#</a> æ–¹æ¡ˆ4ï¼šåˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># åˆ†æ­¥éªŒè¯å†…å­˜ä½¿ç”¨</span>
<span class="token keyword">def</span> <span class="token function">step_by_step_memory_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;=== åˆ†æ­¥å†…å­˜æ£€æŸ¥ ===&quot;</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 1. åŠ è½½æ¨¡å‹</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;1. åŠ è½½æ¨¡å‹...&quot;</span><span class="token punctuation">)</span>
    model <span class="token operator">=</span> AutoModelForTokenClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>
        model_name<span class="token punctuation">,</span> 
        num_labels<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>label2id<span class="token punctuation">)</span><span class="token punctuation">,</span>
        id2label<span class="token operator">=</span>id2label<span class="token punctuation">,</span>
        label2id<span class="token operator">=</span>label2id<span class="token punctuation">,</span>
        torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">,</span>
        device_map<span class="token operator">=</span><span class="token string">&quot;auto&quot;</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;   æ¨¡å‹åŠ è½½åå†…å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># 2. åº”ç”¨LoRA</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;2. åº”ç”¨LoRA...&quot;</span><span class="token punctuation">)</span>
    peft_model <span class="token operator">=</span> get_peft_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> lora_config<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;   LoRAåº”ç”¨åå†…å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> peft_model

peft_model <span class="token operator">=</span> step_by_step_memory_check<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="æ¨èæ‰§è¡Œé¡ºåº"><a href="#æ¨èæ‰§è¡Œé¡ºåº" class="header-anchor">#</a> æ¨èæ‰§è¡Œé¡ºåº</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># å®Œæ•´çš„ä¼˜åŒ–æ–¹æ¡ˆ</span>
<span class="token keyword">def</span> <span class="token function">optimized_training_pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 1. æ¸…ç†å†…å­˜</span>
    torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>empty_cache<span class="token punctuation">(</span><span class="token punctuation">)</span>
    gc<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 2. ä½¿ç”¨å°æ¨¡å‹</span>
    small_model_name <span class="token operator">=</span> <span class="token string">&quot;Qwen/Qwen2.5-1.5B&quot;</span>  <span class="token comment"># æˆ– &quot;Qwen/Qwen2.5-0.5B&quot;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ä½¿ç”¨æ¨¡å‹: </span><span class="token interpolation"><span class="token punctuation">{</span>small_model_name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># 3. é‡æ–°åŠ è½½</span>
    tokenizer <span class="token operator">=</span> AutoTokenizer<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>small_model_name<span class="token punctuation">)</span>
    model <span class="token operator">=</span> AutoModelForTokenClassification<span class="token punctuation">.</span>from_pretrained<span class="token punctuation">(</span>
        small_model_name<span class="token punctuation">,</span> 
        num_labels<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>label2id<span class="token punctuation">)</span><span class="token punctuation">,</span>
        id2label<span class="token operator">=</span>id2label<span class="token punctuation">,</span>
        label2id<span class="token operator">=</span>label2id<span class="token punctuation">,</span>
        torch_dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float16<span class="token punctuation">,</span>
        device_map<span class="token operator">=</span><span class="token string">&quot;auto&quot;</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># 4. æ£€æŸ¥å†…å­˜</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;æ¨¡å‹åŠ è½½åå†…å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># 5. åº”ç”¨LoRA</span>
    peft_model <span class="token operator">=</span> get_peft_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> lora_config<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;LoRAåº”ç”¨åå†…å­˜: </span><span class="token interpolation"><span class="token punctuation">{</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>memory_allocated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> GB&quot;</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> peft_model<span class="token punctuation">,</span> tokenizer

<span class="token comment"># æ‰§è¡Œä¼˜åŒ–æµç¨‹</span>
peft_model<span class="token punctuation">,</span> tokenizer <span class="token operator">=</span> optimized_training_pipeline<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="å…³é”®å»ºè®®"><a href="#å…³é”®å»ºè®®" class="header-anchor">#</a> å…³é”®å»ºè®®</h2> <p><strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨ 1.5B æˆ– 0.5B æ¨¡å‹</strong>ï¼ŒåŸå› ï¼š</p> <ul><li>7Bæ¨¡å‹åœ¨æ‚¨çš„ç¯å¢ƒä¸‹è®­ç»ƒä¼šå¾ˆå›°éš¾</li> <li>1.5Bæ¨¡å‹åœ¨NERä»»åŠ¡ä¸Šè¡¨ç°å·²ç»ä¸é”™</li> <li>å†…å­˜å ç”¨æ›´å¯æ§ï¼Œè®­ç»ƒé€Ÿåº¦æ›´å¿«</li></ul> <p>æ‚¨çš„24GB GPUæ›´é€‚åˆè®­ç»ƒ1.5B-3Bè§„æ¨¡çš„æ¨¡å‹ï¼Œ7Bæ¨¡å‹éœ€è¦æ›´å¤šçš„ä¼˜åŒ–å’Œå¯èƒ½çš„å¤šGPUé…ç½®ã€‚</p> <hr> <h2 id="é”™è¯¯2-step5-æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢"><a href="#é”™è¯¯2-step5-æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢" class="header-anchor">#</a> é”™è¯¯2ï¼Œstep5 æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢</h2> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">process_func</span><span class="token punctuation">(</span>batch_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre></div><p><strong>è¿™ä¸ªå†™æ³•ä¹ŸæŠ¥é”™</strong>, å¾…ç ”ç©¶</p> <div class="language-py extra-class"><pre class="language-py"><code><span class="token comment"># step5 å®šä¹‰æ•°æ®å¤„ç†å‡½æ•°</span>
<span class="token keyword">def</span> <span class="token function">process_func_1</span><span class="token punctuation">(</span>batch_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
  batch_sentence <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'sentence'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>
  batch_labels <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>
  
  batch_inputs <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>
      batch_sentence<span class="token punctuation">,</span>
      padding<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
      truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
      max_length<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>
      return_tensors<span class="token operator">=</span><span class="token string">&quot;pt&quot;</span><span class="token punctuation">,</span>
      is_split_into_words<span class="token operator">=</span><span class="token boolean">True</span>
  <span class="token punctuation">)</span>
  
  aligned_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> i<span class="token punctuation">,</span> labels <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>batch_labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
      word_ids <span class="token operator">=</span> batch_inputs<span class="token punctuation">.</span>word_ids<span class="token punctuation">(</span>batch_index<span class="token operator">=</span>i<span class="token punctuation">)</span>
      token_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      
      <span class="token keyword">for</span> word_idx <span class="token keyword">in</span> word_ids<span class="token punctuation">:</span>
          <span class="token keyword">if</span> word_idx <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
              token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">)</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
              token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label2id<span class="token punctuation">[</span>labels<span class="token punctuation">[</span>word_idx<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      
      aligned_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token_labels<span class="token punctuation">)</span>
  
  <span class="token comment"># batch_inputs['labels'] = torch.tensor(aligned_labels, dtype=torch.long)</span>
  batch_inputs<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>aligned_labels<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
  <span class="token comment"># æ³¨æ„çœ‹è¿™ä¸€æ­¥ï¼Œå‚è€ƒä»£ç æ²¡æœ‰è¿™ä¸€æ­¥æ“ä½œï¼Œ</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token string">'input_ids'</span><span class="token punctuation">:</span> batch_inputs<span class="token punctuation">[</span><span class="token string">'input_ids'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'attention_mask'</span><span class="token punctuation">:</span> batch_inputs<span class="token punctuation">[</span><span class="token string">'attention_mask'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
    <span class="token string">'labels'</span><span class="token punctuation">:</span> batch_inputs<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span>
    <span class="token comment"># &quot;labels&quot;: all_labels # å‚è€ƒä»£ç é‡Œç›´æ¥ç”¨çš„æ˜¯:  aligned_labels å‚è€ƒä»£ç é‡Œé¢çš„å˜é‡æ˜¯: all_labels</span>
  <span class="token punctuation">}</span>
</code></pre></div><hr> <p><strong>è¿™ä¸ªå†™æ³•ä¹Ÿæ˜¯æŠ¥é”™çš„ï¼Œåªèƒ½å…ˆç”¨ä¸å¸ˆå…„ç»™çš„</strong> <code>ner_qwen_lora.ipynb</code> è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†™æ³•</p> <blockquote><p>è¿™ä¸ªæ–‡ä»¶åœ°å€åœ¨: D:\ghh\Downloads\feishu\ner_qwen_lora.ipynb, é‡Œé¢æ²¡ç”¨ <code>word_ids()</code></p></blockquote> <div class="language-py extra-class"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">process_func</span><span class="token punctuation">(</span>batch_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
  batch_sentence <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'sentence'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>
  batch_labels <span class="token operator">=</span> <span class="token punctuation">[</span>sample<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> sample <span class="token keyword">in</span> batch_samples<span class="token punctuation">]</span>
  
  batch_inputs <span class="token operator">=</span> tokenizer<span class="token punctuation">(</span>
    batch_sentence<span class="token punctuation">,</span>
    padding<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    truncation<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    max_length<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span>
    return_tensors<span class="token operator">=</span><span class="token string">&quot;pt&quot;</span><span class="token punctuation">,</span>
    is_split_into_words<span class="token operator">=</span><span class="token boolean">True</span>
  <span class="token punctuation">)</span>
  
  <span class="token comment"># æ ‡ç­¾å¯¹é½é€»è¾‘</span>
  aligned_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>sentence<span class="token punctuation">,</span> labels<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>batch_sentence<span class="token punctuation">,</span> batch_labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      word_ids <span class="token operator">=</span> batch_inputs<span class="token punctuation">.</span>word_ids<span class="token punctuation">(</span>batch_index<span class="token operator">=</span>i<span class="token punctuation">)</span>
      token_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      
      <span class="token comment"># å…ˆåˆ›å»ºå­—ç¬¦çº§æ ‡ç­¾åºåˆ—</span>
      char_level_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'O'</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sentence<span class="token punctuation">)</span>
      <span class="token keyword">for</span> entity <span class="token keyword">in</span> labels<span class="token punctuation">:</span>
          start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> _<span class="token punctuation">,</span> entity_type <span class="token operator">=</span> entity
          <span class="token comment"># è®¾ç½®BIOæ ‡ç­¾</span>
          char_level_labels<span class="token punctuation">[</span>start<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'B-</span><span class="token interpolation"><span class="token punctuation">{</span>entity_type<span class="token punctuation">}</span></span><span class="token string">'</span></span>
          <span class="token keyword">for</span> pos <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              <span class="token keyword">if</span> pos <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>char_level_labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
                  char_level_labels<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'I-</span><span class="token interpolation"><span class="token punctuation">{</span>entity_type<span class="token punctuation">}</span></span><span class="token string">'</span></span>
      
      <span class="token comment"># ç°åœ¨å°†å­—ç¬¦çº§æ ‡ç­¾å¯¹é½åˆ°tokençº§</span>
      previous_word_idx <span class="token operator">=</span> <span class="token boolean">None</span>
      <span class="token keyword">for</span> word_idx <span class="token keyword">in</span> word_ids<span class="token punctuation">:</span>
          <span class="token keyword">if</span> word_idx <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
              token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">)</span>
          <span class="token keyword">elif</span> word_idx <span class="token operator">!=</span> previous_word_idx<span class="token punctuation">:</span>
              <span class="token comment"># æ–°å•è¯çš„ç¬¬ä¸€ä¸ªtoken</span>
              token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label2id<span class="token punctuation">[</span>char_level_labels<span class="token punctuation">[</span>word_idx<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
              <span class="token comment"># åŒä¸€å•è¯çš„åç»­subword tokens</span>
              token_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># æˆ–è€… label2id[char_level_labels[word_idx]]</span>
          previous_word_idx <span class="token operator">=</span> word_idx
      
      aligned_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token_labels<span class="token punctuation">)</span>
  
  batch_inputs<span class="token punctuation">[</span><span class="token string">'labels'</span><span class="token punctuation">]</span> <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>aligned_labels<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
  
  <span class="token keyword">return</span> batch_inputs
</code></pre></div><h2 id="å…¶ä»–é”™è¯¯åœ¨-d-ghh-model-blog-model-blog-docs-vuepress-public-images-fine-tuning-error"><a href="#å…¶ä»–é”™è¯¯åœ¨-d-ghh-model-blog-model-blog-docs-vuepress-public-images-fine-tuning-error" class="header-anchor">#</a> å…¶ä»–é”™è¯¯åœ¨ï¼šD:\ghh\model\blog\model-blog\docs.vuepress\public\images\fine-tuning\error</h2> <p>åœ¨è¿™é‡Œï¼Œå›¾ç‰‡å½¢å¼</p></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#om-é”™è¯¯" class="sidebar-link reco-side-om-é”™è¯¯" data-v-b57cc07c>OM é”™è¯¯</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸ”§-ç«‹å³è§£å†³æ–¹æ¡ˆ" class="sidebar-link reco-side-ğŸ”§-ç«‹å³è§£å†³æ–¹æ¡ˆ" data-v-b57cc07c>ğŸ”§ ç«‹å³è§£å†³æ–¹æ¡ˆ</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ1-æ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°" class="sidebar-link reco-side-æ–¹æ¡ˆ1-æ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°" data-v-b57cc07c>æ–¹æ¡ˆ1ï¼šæ¸…ç†å†…å­˜å¹¶å‡å°‘æ‰¹æ¬¡å¤§å°</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ2-ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯" class="sidebar-link reco-side-æ–¹æ¡ˆ2-ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯" data-v-b57cc07c>æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ¢¯åº¦ç´¯ç§¯</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ3-å¯ç”¨å†…å­˜ä¼˜åŒ–" class="sidebar-link reco-side-æ–¹æ¡ˆ3-å¯ç”¨å†…å­˜ä¼˜åŒ–" data-v-b57cc07c>æ–¹æ¡ˆ3ï¼šå¯ç”¨å†…å­˜ä¼˜åŒ–</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸ¯-å®Œæ•´çš„ä¼˜åŒ–é…ç½®" class="sidebar-link reco-side-ğŸ¯-å®Œæ•´çš„ä¼˜åŒ–é…ç½®" data-v-b57cc07c>ğŸ¯ å®Œæ•´çš„ä¼˜åŒ–é…ç½®</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸ”§-é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯" class="sidebar-link reco-side-ğŸ”§-é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯" data-v-b57cc07c>ğŸ”§ é«˜çº§å†…å­˜ä¼˜åŒ–æŠ€æœ¯</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ4-ä½¿ç”¨deepspeed-æ¨èç”¨äºå¤§æ¨¡å‹" class="sidebar-link reco-side-æ–¹æ¡ˆ4-ä½¿ç”¨deepspeed-æ¨èç”¨äºå¤§æ¨¡å‹" data-v-b57cc07c>æ–¹æ¡ˆ4ï¼šä½¿ç”¨DeepSpeedï¼ˆæ¨èç”¨äºå¤§æ¨¡å‹ï¼‰</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ5-æ¨¡å‹å†…å­˜ä¼˜åŒ–" class="sidebar-link reco-side-æ–¹æ¡ˆ5-æ¨¡å‹å†…å­˜ä¼˜åŒ–" data-v-b57cc07c>æ–¹æ¡ˆ5ï¼šæ¨¡å‹å†…å­˜ä¼˜åŒ–</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸš€-ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ" class="sidebar-link reco-side-ğŸš€-ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ" data-v-b57cc07c>ğŸš€ ç«‹å³æ‰§è¡Œçš„ç´§æ€¥æ–¹æ¡ˆ</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸ’¡-é¢„é˜²æªæ–½" class="sidebar-link reco-side-ğŸ’¡-é¢„é˜²æªæ–½" data-v-b57cc07c>ğŸ’¡ é¢„é˜²æªæ–½</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ç›‘æ§gpuå†…å­˜" class="sidebar-link reco-side-ç›‘æ§gpuå†…å­˜" data-v-b57cc07c>ç›‘æ§GPUå†…å­˜</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ä½¿ç”¨æ›´å°çš„æ¨¡å‹" class="sidebar-link reco-side-ä½¿ç”¨æ›´å°çš„æ¨¡å‹" data-v-b57cc07c>ä½¿ç”¨æ›´å°çš„æ¨¡å‹</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#ğŸ¯-æ¨èæ‰§è¡Œé¡ºåº" class="sidebar-link reco-side-ğŸ¯-æ¨èæ‰§è¡Œé¡ºåº" data-v-b57cc07c>ğŸ¯ æ¨èæ‰§è¡Œé¡ºåº</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#omé”™è¯¯-æ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ" class="sidebar-link reco-side-omé”™è¯¯-æ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ" data-v-b57cc07c>OMé”™è¯¯ï¼Œæ¸…ç†å†…å­˜åå†å¼€å§‹è®­ç»ƒ</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#å†…å­˜åˆ†æ" class="sidebar-link reco-side-å†…å­˜åˆ†æ" data-v-b57cc07c>å†…å­˜åˆ†æ</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#å…·ä½“é—®é¢˜åˆ†æ" class="sidebar-link reco-side-å…·ä½“é—®é¢˜åˆ†æ" data-v-b57cc07c>å…·ä½“é—®é¢˜åˆ†æ</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#è§£å†³æ–¹æ¡ˆ" class="sidebar-link reco-side-è§£å†³æ–¹æ¡ˆ" data-v-b57cc07c>è§£å†³æ–¹æ¡ˆ</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ1-ç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½" class="sidebar-link reco-side-æ–¹æ¡ˆ1-ç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½" data-v-b57cc07c>æ–¹æ¡ˆ1ï¼šç«‹å³æ¸…ç†ç¼“å­˜å¹¶é‡æ–°åŠ è½½</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ2-ä½¿ç”¨æ›´å°çš„æ¨¡å‹-æ¨è" class="sidebar-link reco-side-æ–¹æ¡ˆ2-ä½¿ç”¨æ›´å°çš„æ¨¡å‹-æ¨è" data-v-b57cc07c>æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ›´å°çš„æ¨¡å‹ï¼ˆæ¨èï¼‰</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ3-ä¼˜åŒ–æ•°æ®åŠ è½½" class="sidebar-link reco-side-æ–¹æ¡ˆ3-ä¼˜åŒ–æ•°æ®åŠ è½½" data-v-b57cc07c>æ–¹æ¡ˆ3ï¼šä¼˜åŒ–æ•°æ®åŠ è½½</a></li><li class="level-3" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ–¹æ¡ˆ4-åˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ" class="sidebar-link reco-side-æ–¹æ¡ˆ4-åˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ" data-v-b57cc07c>æ–¹æ¡ˆ4ï¼šåˆ†æ­¥åŠ è½½å’Œè®­ç»ƒ</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#æ¨èæ‰§è¡Œé¡ºåº" class="sidebar-link reco-side-æ¨èæ‰§è¡Œé¡ºåº" data-v-b57cc07c>æ¨èæ‰§è¡Œé¡ºåº</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#å…³é”®å»ºè®®" class="sidebar-link reco-side-å…³é”®å»ºè®®" data-v-b57cc07c>å…³é”®å»ºè®®</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#é”™è¯¯2-step5-æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢" class="sidebar-link reco-side-é”™è¯¯2-step5-æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢" data-v-b57cc07c>é”™è¯¯2ï¼Œstep5 æ•°æ®å¤„ç†å‡½æ•°ä¸Šé¢</a></li><li class="level-2" data-v-b57cc07c><a href="/hmblog/modelstudy/finetuning-error-collect.html#å…¶ä»–é”™è¯¯åœ¨-d-ghh-model-blog-model-blog-docs-vuepress-public-images-fine-tuning-error" class="sidebar-link reco-side-å…¶ä»–é”™è¯¯åœ¨-d-ghh-model-blog-model-blog-docs-vuepress-public-images-fine-tuning-error" data-v-b57cc07c>å…¶ä»–é”™è¯¯åœ¨ï¼šD:\ghh\model\blog\model-blog\docs\.vuepress\public\images\fine-tuning\error</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/hmblog/assets/js/app.252ae38c.js" defer></script><script src="/hmblog/assets/js/7.5041dce4.js" defer></script><script src="/hmblog/assets/js/2.79670d2b.js" defer></script><script src="/hmblog/assets/js/1.1d6abb18.js" defer></script><script src="/hmblog/assets/js/76.f614fd28.js" defer></script><script src="/hmblog/assets/js/34.b26cede8.js" defer></script>
  </body>
</html>
